Compiling Program: C:\DojoManager\AppSrc\WebApp.src
Memory Available: 1281490943
1>Use AllWebAppClasses.pkg
Using pre-compiled package ALLWEBAPPCLASSES.PKG
Including file: AllWebAppClasses.pkd    (C:\Program Files (x86)\DataFlex 18.2\Pkg\AllWebAppClasses.pkd)
28834>Use cWebMenuItemLoadView.pkg
28834>
28834>Object oApplication is a cApplication
28836>End_Object
28837>
28837>Object oWebApp is a cWebApp
28839>    Set psTheme to "Df_Web_Creme"
28840>    Set psEncryptPassword to "^j>fAj1@qj^jjpyq)zBt/a?|(z*0\b2Zzn:mk2fL"
28841>
28841>    Object oCommandbar is a cWebCommandBar                
28843>        Object oMenuBar is a cWebMenuBar
28845>            Object oFileMenu is a cWebMenuItem
28847>                Set psCaption to C_$File
28848>                
28848>                Object oClearMenuItem is a cWebMenuClear
28850>                End_Object  
28851>                             
28851>                Object oClearAllMenuItem is a cWebMenuClearAll
28853>                End_Object  
28854>                
28854>                Object oPromptMenuItem is a cWebMenuPrompt
28856>                    Set pbBeginGroup to True
28857>                End_Object  
28858>                               
28858>                Object oFindMenuItem is a cWebMenuFind
28860>                End_Object  
28861>
28861>                Object oNextMenuItem is a cWebMenuFindNext
28863>                End_Object  
28864>
28864>                Object oPreviousMenuItem is a cWebMenuFindPrevious
28866>                End_Object  
28867>                
28867>                Object oLastMenuItem is a cWebMenuFindLast
28869>                End_Object                
28870>                                
28870>                Object oFirstMenuItem is a cWebMenuFindFirst
28872>                End_Object  
28873>                
28873>                Object oSaveMenuItem is a cWebMenuSave
28875>                    Set pbBeginGroup to True
28876>                End_Object  
28877>                
28877>                Object oDeleteMenuItem is a cWebMenuDelete
28879>                End_Object  
28880>                
28880>                Object oLoginMenuItem is a cWebMenuItem
28882>                    Set psCaption to C_$LogIn
28883>                    Set pbBeginGroup to True
28884>                    Set psCSSClass to "WebLoginMenuItem"
28885>
28885>                    Procedure OnClick
28888>                        Send RequestLogin to ghoWebSessionManager
28889>                    End_Procedure
28890>                    
28890>                    Procedure OnLoad
28893>                        Integer eLoginMode
28893>                        Handle hoLogin
28893>                        Get GetLoginView to hoLogin
28894>                        Get peLoginMode to eLoginMode
28895>                        WebSet pbRender to  (hoLogin and eLoginMode<>lmLoginNone)
28896>                    End_Procedure  // OnLoad
28897>                    
28897>                End_Object  
28898>
28898>                Object oLogoutMenuItem is a cWebMenuItem
28900>                    Set psCaption to C_$LogOut
28901>                    Set psCSSClass to "WebLogoutMenuItem"
28902>
28902>                    Procedure OnClick
28905>                        Send RequestLogOut of ghoWebSessionManager
28906>                    End_Procedure
28907>
28907>                    Procedure OnLoad
28910>                        Integer eLoginMode
28910>                        Handle hoLogin
28910>                        Get GetLoginView to hoLogin
28911>                        Get peLoginMode to eLoginMode
28912>                        WebSet pbRender to  (hoLogin and eLoginMode<>lmLoginNone)
28913>                    End_Procedure
28914>                End_Object  
28915>            End_Object  
28916>    
28916>            Object oViewMenu is a cWebMenuItem
28918>                Set psCaption to C_$View
28919>
28919>                Object oDojoEntryItem1 is a cWebMenuItemLoadView
28921>                    Set psCaption to "Dojo Entry"
28922>                    Set psLoadViewOnClick to "oDojo"
28923>                End_Object
28924>
28924>                Object oInstructors is a cWebMenuItemLoadView
28926>                    Set psCaption to "Instructors"
28927>                    Set psLoadViewOnClick to "oInstructors"
28928>                End_Object
28929>
28929>                Object oMembersItem1 is a cWebMenuItemLoadView
28931>                    Set psCaption to "Members"
28932>                    Set psLoadViewOnClick to "oMembers"
28933>                End_Object
28934>
28934>                Object oSeminarsItem1 is a cWebMenuItemLoadView
28936>                    Set psCaption to "Seminars"
28937>                    Set psLoadViewOnClick to "oSeminars"
28938>                End_Object
28939>
28939>                Object oSettingsItem1 is a cWebMenuItemLoadView
28941>                    Set psCaption to "Settings"
28942>                    Set psLoadViewOnClick to "oSettings"
28943>                End_Object
28944>
28944>            End_Object  
28945>        End_Object  
28946>        
28946>        Object oFindToolBar is a cWebToolBar
28948>            Object oFirstMenuItem is a cWebMenuFindFirst
28950>            End_Object  
28951>    
28951>            Object oPreviousMenuItem is a cWebMenuFindPrevious
28953>            End_Object  
28954>
28954>            Object oFindMenuItem is a cWebMenuFind
28956>            End_Object  
28957>
28957>            Object oNextMenuItem is a cWebMenuFindNext
28959>            End_Object  
28960>            
28960>            Object oLastMenuItem is a cWebMenuFindLast
28962>            End_Object
28963>                           
28963>            Object oPromptMenuItem is a cWebMenuPrompt
28965>            End_Object 
28966>        End_Object
28967>        
28967>        Object oFileToolBar is a cWebToolBar
28969>            Set pbShowCaption to True
28970>            
28970>            Object oClearMenuItem is a cWebMenuClear
28972>            End_Object              
28973>             
28973>            Object oClearAllMenuItem is a cWebMenuClearAll
28975>            End_Object   
28976>                        
28976>            Object oSaveMenuItem is a cWebMenuSave
28978>            End_Object  
28979>            
28979>            Object oDeleteMenuItem is a cWebMenuDelete
28981>            End_Object 
28982>        End_Object
28983>    End_Object
28984>
28984>    Use SessionManager.wo
Including file: SessionManager.wo    (C:\DojoManager\AppSrc\SessionManager.wo)
28984>>>Use cWebSessionManagerStandard.pkg
Including file: cWebSessionManagerStandard.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cWebSessionManagerStandard.pkg)
28984>>>>>Use cWebSessionManager.pkg
28984>>>>>Use cWebAppSessionDataDictionary.dd
Including file: cWebAppSessionDataDictionary.dd    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cWebAppSessionDataDictionary.dd)
28984>>>>>>>Use DataDict.pkg
28984>>>>>>>
28984>>>>>>>Open WebAppSession
Including file: WebAppSession.fd    (C:\DojoManager\DDSrc\WebAppSession.fd)
28986>>>>>>>Open WebAppUser
Including file: WebAppUser.fd    (C:\DojoManager\DDSrc\WebAppUser.fd)
28988>>>>>>>
28988>>>>>>>Class cWebAppSessionDataDictionary is a DataDictionary
28989>>>>>>>    
28989>>>>>>>    Procedure Construct_Object
28991>>>>>>>        Forward Send Construct_Object
28993>>>>>>>        Set Main_File to WebAppSession.File_Number
28994>>>>>>>
28994>>>>>>>        Set Add_Server_File to WebAppUser.File_Number
28995>>>>>>>
28995>>>>>>>        Set ParentNullAllowed WebAppUser.File_Number to True
28996>>>>>>>
28996>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
28997>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
28998>>>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
28999>>>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
29000>>>>>>>
29000>>>>>>>        Set Field_Option Field WebAppSession.Active DD_RETAIN to True
29001>>>>>>>        Set Field_Checkbox_Values Field WebAppSession.Active to "Y" "N"
29002>>>>>>>        Set Field_Error Field WebAppSession.Active to 500 "Invalid WebAppSession Active State"
29003>>>>>>>
29003>>>>>>>    End_Procedure
29004>>>>>>>
29004>>>>>>>    Procedure Creating
29006>>>>>>>        DateTime dtCurrentDateTime
29006>>>>>>>        
29006>>>>>>>        Forward Send Creating
29008>>>>>>>        
29008>>>>>>>        //  Init usecounter
29008>>>>>>>        Move 0 to WebAppSession.UseCount
29009>>>>>>>        
29009>>>>>>>        //  Set the creation and access time to the current time
29009>>>>>>>        Move (CurrentDateTime()) to dtCurrentDateTime
29010>>>>>>>    
29010>>>>>>>        Get TimeToString dtCurrentDateTime to WebAppSession.CreateTime
29011>>>>>>>        Get TimeToString dtCurrentDateTime to WebAppSession.LastAccessTime
29012>>>>>>>        
29012>>>>>>>        Move dtCurrentDateTime to WebAppSession.CreateDate
29013>>>>>>>        Move dtCurrentDateTime to WebAppSession.LastAccessDate
29014>>>>>>>    End_Procedure
29015>>>>>>>    
29015>>>>>>>    
29015>>>>>>>    
29015>>>>>>>    //
29015>>>>>>>    //  Converts the given time to an string that can be saved in the database.
29015>>>>>>>    //
29015>>>>>>>    //  Params:
29015>>>>>>>    //      dtTime  Time to convert
29015>>>>>>>    //  Returns:
29015>>>>>>>    //      String with "HH:MM:SS" format
29015>>>>>>>    //
29015>>>>>>>    Function TimeToString DateTime dtTime Returns String
29017>>>>>>>        String sHours sMinutes sSeconds
29017>>>>>>>        
29017>>>>>>>        //  Extract parts
29017>>>>>>>        Move (String(DateGetHour(dtTime))) to sHours
29018>>>>>>>        Move (String(DateGetMinute(dtTime))) to sMinutes
29019>>>>>>>        Move (String(DateGetSecond(dtTime))) to sSeconds
29020>>>>>>>        
29020>>>>>>>        //  Fill out with 0
29020>>>>>>>        If (Length(sHours) = 1) Move ("0" + sHours) to sHours
29023>>>>>>>        If (Length(sMinutes) = 1) Move ("0" + sMinutes) to sMinutes
29026>>>>>>>        If (Length(sSeconds) = 1) Move ("0" + sSeconds) to sSeconds
29029>>>>>>>        
29029>>>>>>>        Function_Return (sHours + ":" + sMinutes + ":" + sSeconds)
29030>>>>>>>    End_Function
29031>>>>>>>    
29031>>>>>>>    //
29031>>>>>>>    //  Sets the time of the datetime variable to the time in the string.
29031>>>>>>>    //
29031>>>>>>>    //  Params:
29031>>>>>>>    //      dtTime  Datetime variable to add time to
29031>>>>>>>    //      sTimeString String with time in the format "HH:MM:SS"
29031>>>>>>>    //  Returns:
29031>>>>>>>    //      dtDateTime with the loaded time
29031>>>>>>>    //
29031>>>>>>>    Function StringToTime DateTime dtTime String sTimeString Returns DateTime
29033>>>>>>>        String sHours sMinutes sSeconds
29033>>>>>>>        
29033>>>>>>>        //  Extract parts
29033>>>>>>>        Move (Mid(sTimeString, 2, 1)) to sHours
29034>>>>>>>        Move (Mid(sTimeString, 2, 4)) to sMinutes
29035>>>>>>>        Move (Mid(sTimeString, 2, 7)) to sSeconds
29036>>>>>>>        
29036>>>>>>>        //  Set to DateTime
29036>>>>>>>        Move (DateSetHour(dtTime, (Integer(sHours)))) to dtTime
29037>>>>>>>        Move (DateSetMinute(dtTime, (Integer(sMinutes)))) to dtTime
29038>>>>>>>        Move (DateSetSecond(dtTime, (Integer(sSeconds)))) to dtTime
29039>>>>>>>        
29039>>>>>>>        Function_Return dtTime
29040>>>>>>>    End_Function
29041>>>>>>>
29041>>>>>>>End_Class
29042>>>>>Use cWebAppUserDataDictionary.dd
Including file: cWebAppUserDataDictionary.dd    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cWebAppUserDataDictionary.dd)
29042>>>>>>>Use DataDict.pkg
29042>>>>>>>Open WebAppUser
29044>>>>>>>Open WebAppSession
29046>>>>>>>
29046>>>>>>>Class cWebAppUserDataDictionary is a DataDictionary
29047>>>>>>>    
29047>>>>>>>    Procedure Construct_Object
29049>>>>>>>        Forward Send Construct_Object
29051>>>>>>>        Set Main_File to WebAppUser.File_Number
29052>>>>>>>
29052>>>>>>>        Set Add_Client_File to WebAppSession.File_Number
29053>>>>>>>
29053>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
29054>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
29055>>>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
29056>>>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
29057>>>>>>>    End_Procedure
29058>>>>>>>
29058>>>>>>>End_Class
29059>>>>>
29059>>>>>Class cWebSessionManagerStandard is a cWebSessionManager
29060>>>>>    
29060>>>>>    Procedure Construct_Object
29062>>>>>        Handle hoUserDD hoSessionDD
29062>>>>>        
29062>>>>>        Forward Send Construct_Object
29064>>>>>        
29064>>>>>        Property Handle phoUserDD 0      // Handle to the WebAppUser DDO
29065>>>>>        Property Handle phoSessionDD 0   // Handle to the WebAppSession DDO        
29066>>>>>        
29066>>>>>        Get Create (RefClass(cWebAppUserDataDictionary)) to hoUserDD
29067>>>>>        Get Create (RefClass(cWebAppSessionDataDictionary)) to hoSessionDD
29068>>>>>        Set DDO_Server of hoSessionDD to hoUserDD
29069>>>>>
29069>>>>>        Set phoUserDD to hoUserDD
29070>>>>>        Set phoSessionDD to hoSessionDD
29071>>>>>        Property Boolean pbCreatingNewSession False
29072>>>>>        Property Integer piSessionTimeout 480        
29073>>>>>        Property String psLoginName
29074>>>>>        Property String psUserName ""
29075>>>>>        Property Integer piUserRights 0
29076>>>>>    End_Procedure
29077>>>>>    
29077>>>>>    Function CreateSession String sRemoteAddress Returns String
29079>>>>>        String sSessionKey
29079>>>>>        Integer iErr
29079>>>>>        Boolean bLogWebSession
29079>>>>>        Handle hoSessionDD       
29079>>>>>        Get phoSessionDD to hoSessionDD
29080>>>>>        
29080>>>>>        //  Get session key
29080>>>>>        Forward Get CreateSession sRemoteAddress to sSessionKey
29082>>>>>        
29082>>>>>        Get pbLogWebSession to bLogWebSession
29083>>>>>        If not bLogWebSession Begin
29085>>>>>            Function_Return sSessionKey        
29086>>>>>        End
29086>>>>>>
29086>>>>>
29086>>>>>        //  Store session
29086>>>>>        Send Clear of hoSessionDD
29087>>>>>        Set Field_Changed_Value of hoSessionDD Field WebAppSession.SessionKey to sSessionKey
29088>>>>>        Set Field_Changed_Value of hoSessionDD Field WebAppSession.RemoteAddress to sRemoteAddress
29089>>>>>        Set Field_Changed_Value of hoSessionDD Field WebAppSession.Active to "Y"
29090>>>>>        Get Request_Validate of hoSessionDD to iErr
29091>>>>>        If (iErr) Begin
29093>>>>>            // this should not happen. If it does its a programming error
29093>>>>>            Error DFERR_PROGRAM C_$WebAppSesionValidateFailed
29094>>>>>>
29094>>>>>            Function_Return ""
29095>>>>>        End
29095>>>>>>
29095>>>>>        Send Request_Save of hoSessionDD
29096>>>>>       
29096>>>>>        Function_Return sSessionKey        
29097>>>>>    End_Function
29098>>>>>    
29098>>>>>    
29098>>>>>    Function ValidateSession String sSessionKey Returns Boolean
29100>>>>>        DateTime dtLastAccess dtCurrent
29100>>>>>        TimeSpan tsDiff
29100>>>>>        Integer iErr iSessionTimeout iSpanMinutes
29100>>>>>        Boolean bResult bCreatingNewSession
29100>>>>>        Boolean bLogWebSession 
29100>>>>>        Integer eLoginMode
29100>>>>>        String sTime
29100>>>>>        Handle hoSessionDD hoUserDD       
29100>>>>>        
29100>>>>>        Get phoSessionDD to hoSessionDD
29101>>>>>        Get phoUserDD to hoUserDD
29102>>>>>        
29102>>>>>        Get pbLogWebSession to bLogWebSession
29103>>>>>        Get peLoginMode to eLoginMode
29104>>>>>        
29104>>>>>        // for this object, you can only disable logging if login completely is disabled
29104>>>>>        If (not(bLogWebSession) and (eLoginMode<>lmLoginNone)) Begin
29106>>>>>            Error DFERR_PROGRAM C_$WebSessionLoggingMustBeEnabled
29107>>>>>>
29107>>>>>            Function_Return False
29108>>>>>        End
29108>>>>>>
29108>>>>>
29108>>>>>        //  Clear session properties
29108>>>>>        Send UpdateSessionProperties True
29109>>>>>        
29109>>>>>        If not bLogWebSession Begin
29111>>>>>            Forward Get ValidateSession sSessionKey to bResult
29113>>>>>            Function_Return bResult
29114>>>>>        End        
29114>>>>>>
29114>>>>>        
29114>>>>>        Move False to bResult
29115>>>>>        Get piSessionTimeout to iSessionTimeout 
29116>>>>>        
29116>>>>>        //  Check if session exists
29116>>>>>        Send Clear of hoSessionDD
29117>>>>>        Move sSessionKey to WebAppSession.SessionKey
29118>>>>>        Send Find of hoSessionDD EQ Index.1
29119>>>>>            
29119>>>>>        If (Found) Begin
29121>>>>>            //  Calculate timespan between now and last access time
29121>>>>>            Move (CurrentDateTime()) to dtCurrent
29122>>>>>            Move WebAppSession.LastAccessDate to dtLastAccess
29123>>>>>            Get StringToTime of hoSessionDD dtLastAccess WebAppSession.LastAccessTime to dtLastAccess
29124>>>>>            Move (dtCurrent - dtLastAccess) to tsDiff
29125>>>>>            Move (SpanTotalMinutes(tsDiff)) to iSpanMinutes
29126>>>>>            
29126>>>>>            //  Check if session didn't time out
29126>>>>>            If ((iSessionTimeout <= 0 or (iSpanMinutes < iSessionTimeout)) and WebAppSession.Active = "Y") Begin
29128>>>>>                Forward Get ValidateSession sSessionKey to bResult
29130>>>>>                   
29130>>>>>                If (bResult) Begin
29132>>>>>                    //  Update session record
29132>>>>>                    Get TimeToString of hoSessionDD dtCurrent to sTime 
29133>>>>>                    Set Field_Changed_Value of hoSessionDD Field WebAppSession.LastAccessDate to dtCurrent
29134>>>>>                    Set Field_Changed_Value of hoSessionDD Field WebAppSession.LastAccessTime to sTime
29135>>>>>                    Set Field_Changed_Value of hoSessionDD Field WebAppSession.UseCount to (WebAppSession.UseCount + 1)
29136>>>>>                    Get Request_Validate of hoSessionDD to iErr
29137>>>>>                    If (iErr) Begin
29139>>>>>                        // this should not happen. If it does its a programming error
29139>>>>>                        Error DFERR_PROGRAM C_$WebAppSesionValidateFailed
29140>>>>>>
29140>>>>>                        Function_Return False
29141>>>>>                    End
29141>>>>>>
29141>>>>>                    Send Request_Save of hoSessionDD
29142>>>>>                    
29142>>>>>                    //  Update user properties
29142>>>>>                    Send UpdateSessionProperties False
29143>>>>>                End
29143>>>>>>
29143>>>>>            End
29143>>>>>>
29143>>>>>            Else Begin
29144>>>>>                // Test the Creating New Session Flag to protect against infinite recursion....
29144>>>>>                Get pbCreatingNewSession to bCreatingNewSession
29145>>>>>                
29145>>>>>                If (not(bCreatingNewSession)) Begin
29147>>>>>                    Set pbCreatingNewSession to True                    
29148>>>>>                    Send RecreateSession to ghoWebApp
29149>>>>>                    Error DFERR_WEBAPP_SESSION_TIMEOUT "Your application session has timed out or is inactive, please login again."
29150>>>>>>
29150>>>>>                    Send NavigateRefresh of ghoWebApp          // refresh the WebApp at the client (triggers a login)
29151>>>>>                    Set pbCreatingNewSession to False
29152>>>>>                End
29152>>>>>>
29152>>>>>            End
29152>>>>>>
29152>>>>>        End
29152>>>>>>
29152>>>>>        Else Begin
29153>>>>>            Error DFERR_WEBAPP_BAD_SESSION_KEY "Session key not known (reload page to recreate session)"
29154>>>>>>
29154>>>>>        End
29154>>>>>>
29154>>>>>        
29154>>>>>        Function_Return bResult
29155>>>>>    End_Function
29156>>>>>    
29156>>>>>    Function UserLogin String sLoginName String sPassword Returns Boolean
29158>>>>>        String sSessionKey sUserPassword
29158>>>>>        Handle hoSessionDD hoUserDD
29158>>>>>        Boolean bMatch  
29158>>>>>        
29158>>>>>        Get phoSessionDD to hoSessionDD
29159>>>>>        Get phoUserDD to hoUserDD
29160>>>>>        Integer iErr eLoginMode
29160>>>>>        
29160>>>>>        // Refind session record
29160>>>>>        Get psSessionKey to sSessionKey
29161>>>>>        Send Clear of hoSessionDD
29162>>>>>        Move sSessionKey to WebAppSession.SessionKey
29163>>>>>        Send Find of hoSessionDD EQ Index.1
29164>>>>>        
29164>>>>>        If (Found and WebAppSession.SessionKey = sSessionKey) Begin
29166>>>>>            Get peLoginMode to eLoginMode
29167>>>>>            
29167>>>>>            //  Find the user
29167>>>>>            Move sLoginName to WebAppUser.LoginName
29168>>>>>            Send Find of hoUserDD EQ Index.1
29169>>>>>            
29169>>>>>            // Check username and password
29169>>>>>            If (Found and (Lowercase(sLoginName) = Lowercase(Trim(WebAppUser.LoginName)))) Begin
29171>>>>>                Get Field_Current_Value of hoUserDD Field WebAppUser.Password to sUserPassword
29172>>>>>                Get ComparePasswords (Trim(sUserPassword)) (Trim(sPassword)) to bMatch
29173>>>>>                
29173>>>>>                If (bMatch) Begin
29175>>>>>                    // Store the login
29175>>>>>                    Set Field_Changed_Value of hoUserDD Field WebAppUser.LastLogin to (CurrentDateTime())
29176>>>>>                    Get Request_Validate of hoSessionDD to iErr
29177>>>>>                    If (iErr) Begin
29179>>>>>                        // this should not happen. If it does its a programming error
29179>>>>>                        Error DFERR_PROGRAM C_$WebAppSesionValidateFailed
29180>>>>>>
29180>>>>>                        Function_Return False
29181>>>>>                    End
29181>>>>>>
29181>>>>>                    
29181>>>>>                    Send Request_Save of hoSessionDD
29182>>>>>                    
29182>>>>>                    // Update session properties
29182>>>>>                    Send UpdateSessionProperties False
29183>>>>>                    Send NotifyChangeRights
29184>>>>>                    Function_Return True
29185>>>>>                End
29185>>>>>>
29185>>>>>                Else Begin
29186>>>>>                    //  We should rely directly on this buffer elsewhere but just be sure
29186>>>>>                    Send Clear of hoUserDD
29187>>>>>                End
29187>>>>>>
29187>>>>>            End
29187>>>>>>
29187>>>>>        End
29187>>>>>>
29187>>>>>          
29187>>>>>        Function_Return False
29188>>>>>    End_Function
29189>>>>>    
29189>>>>>    Function IsLoggedIn Returns Boolean
29191>>>>>        String sLoginName
29191>>>>>        Boolean bLogWebSession bLoggedIn
29191>>>>>        
29191>>>>>        Get pbLogWebSession to bLogWebSession
29192>>>>>        If not bLogWebSession Begin
29194>>>>>            Forward Get IsLoggedIn to bLoggedIn
29196>>>>>            Function_Return bLoggedIn
29197>>>>>        End
29197>>>>>>
29197>>>>>        
29197>>>>>        Get psLoginName to sLoginName
29198>>>>>        
29198>>>>>        Function_Return (sLoginName <> "")
29199>>>>>    End_Function
29200>>>>>    
29200>>>>>    
29200>>>>>    //
29200>>>>>    // This procedure is called when validating a session and after logging in. Its purpose is to 
29200>>>>>    // update properties based on the session and user data. Augment this function to update 
29200>>>>>    // properties based on the session / user table. Note that WebAppUser and WebAppSession contain
29200>>>>>    // the right records when this procedure is called.
29200>>>>>    //
29200>>>>>    // Params:
29200>>>>>    //      bClear   True if the procedure is called before session validation to clear properties.
29200>>>>>    //
29200>>>>>    Procedure UpdateSessionProperties Boolean bClear
29202>>>>>        Handle hoUserDD
29202>>>>>        
29202>>>>>        Get phoUserDD to hoUserDD
29203>>>>>        
29203>>>>>        //  Update user properties
29203>>>>>        If (not(bClear) and HasRecord(hoUserDD)) Begin
29205>>>>>            Set psUsername to (Trim(WebAppUser.FullName))
29206>>>>>            Set psLoginName to (Trim(WebAppUser.LoginName))
29207>>>>>            Set piUserRights to WebAppUser.Rights
29208>>>>>            
29208>>>>>            Send OnSessionPropertiesSet 
29209>>>>>        End
29209>>>>>>
29209>>>>>        Else Begin
29210>>>>>            Set psUsername to ""
29211>>>>>            Set psLoginName to ""
29212>>>>>            Set piUserRights to 0
29213>>>>>            
29213>>>>>            Send OnSessionPropertiesClear
29214>>>>>        End
29214>>>>>>
29214>>>>>    End_Procedure
29215>>>>>    
29215>>>>>    //
29215>>>>>    // This function is called to perform the password comparison. It gets the entered password and
29215>>>>>    // the password value of the user table as parameters. The WebAppUser buffer will contain the
29215>>>>>    // right record. This function can be augmented to implement security features like storing the
29215>>>>>    // password as a hashed value.
29215>>>>>    //
29215>>>>>    // Params:
29215>>>>>    //      sUserPassword       Value of the WebAppUser.Password field.
29215>>>>>    //      sEnteredPassword    Value entered on the login screen during login.
29215>>>>>    //
29215>>>>>    Function ComparePasswords String sUserPassword String sEnteredPassword Returns Boolean
29217>>>>>        Function_Return (sUserPassword = sEnteredPassword)
29218>>>>>    End_Function
29219>>>>>    
29219>>>>>    Procedure OnSessionPropertiesSet
29221>>>>>        //  Empty event stub
29221>>>>>    End_Procedure
29222>>>>>    
29222>>>>>    Procedure OnSessionPropertiesClear
29224>>>>>        //  Empty event stub
29224>>>>>    End_Procedure
29225>>>>>    
29225>>>>>    Procedure EndSession
29227>>>>>        Integer iErr
29227>>>>>        Boolean bLogWebSession
29227>>>>>        Handle hoSessionDD       
29227>>>>>        
29227>>>>>        Get phoSessionDD to hoSessionDD
29228>>>>>        Get pbLogWebSession to bLogWebSession
29229>>>>>        If not bLogWebSession Begin
29231>>>>>            Forward Send EndSession
29233>>>>>            Procedure_Return
29234>>>>>        End
29234>>>>>>
29234>>>>>            
29234>>>>>        //  Check if session exists
29234>>>>>        Send Clear of hoSessionDD
29235>>>>>        Get psSessionKey to WebAppSession.SessionKey
29236>>>>>        
29236>>>>>        Send Find of hoSessionDD EQ Index.1
29237>>>>>        If (Found) Begin
29239>>>>>            Set Field_Changed_Value of hoSessionDD Field WebAppSession.Active to "N"
29240>>>>>            Get Request_Validate of hoSessionDD to iErr
29241>>>>>            If (iErr) Begin
29243>>>>>                // this should not happen. If it does its a programming error
29243>>>>>                Error DFERR_PROGRAM C_$WebAppSesionValidateFailed
29244>>>>>>
29244>>>>>                Procedure_Return
29245>>>>>            End
29245>>>>>>
29245>>>>>            Send Request_Save of hoSessionDD
29246>>>>>        End
29246>>>>>>
29246>>>>>    End_Procedure
29247>>>>>
29247>>>>>End_Class
29248>>>>>
29248>>>
29248>>>Object oSessionManager is a cWebSessionManagerStandard
29250>>>End_Object
29251>>>
29251>    Use LoginDialog.wo
Including file: LoginDialog.wo    (C:\DojoManager\AppSrc\LoginDialog.wo)
29251>>>Use cWebModalDialog.pkg
29251>>>Use cWebForm.pkg
29251>>>Use cWebButton.pkg
29251>>>Use cWebPanel.pkg
29251>>>Use cWebLabel.pkg
29251>>>
29251>>>Object oLoginDialog is a cWebModalDialog
29253>>>    Set piMinWidth to 370
29254>>>    Set piMinHeight to 220
29255>>>    Set psCaption to "Login"
29256>>>    Set pbShowClose to (peLoginMode(oWebApp) <> lmLoginRequired)
29257>>>    Set pbLoginModeEnforced to False
29258>>>    
29258>>>    Delegate Set phoLoginView to Self
29260>>>    
29260>>>    Object oTopPanel is a cWebPanel
29262>>>        Set peRegion to prTop
29263>>>        Set piHeight to 55       
29264>>>        
29264>>>        Object oDescription is a cWebLabel
29266>>>            Set psCaption to "Please enter your username and password to login."
29267>>>            Set peAlign to alignCenter
29268>>>        End_Object
29269>>>    End_Object
29270>>>    
29270>>>    Object oRightPanel is a cWebPanel
29272>>>        Set peRegion to prRight
29273>>>        Set piWidth to 20       
29274>>>    End_Object
29275>>>    
29275>>>    Object oMainPanel is a cWebPanel
29277>>>        Set peRegion to prCenter
29278>>>        
29278>>>        Object oLoginName is a cWebForm
29280>>>            Set psLabel to "Login Name:"
29281>>>            Set peLabelPosition to C_WebDefault
29282>>>            Set peLabelAlign to alignRight
29283>>>            Set piMaxLength to 20
29284>>>        End_Object
29285>>>        
29285>>>        Object oPassword is a cWebForm
29287>>>            Set psLabel to "Password:"
29288>>>            Set pbPassword to True
29289>>>            Set peLabelAlign to alignRight
29290>>>            Set piMaxLength to 20
29291>>>        End_Object   
29292>>>        
29292>>>        Object oWarning is a cWebLabel
29294>>>            Set pbVisible to False
29295>>>            Set psCaption to "Invalid loginname or password."
29296>>>            Set psCSSClass to "Warning"
29297>>>            Set peAlign to alignCenter
29298>>>        End_Object
29299>>>    End_Object
29300>>>    
29300>>>    Object oButtonPanel is a cWebPanel
29302>>>        Set peRegion to prBottom
29303>>>        Set piColumnCount to 3
29304>>>        Set piMinHeight to 40
29305>>>
29305>>>        Object oLoginButton is a cWebButton
29307>>>            Set pbShowLabel to False
29308>>>            Set piColumnIndex to 2
29309>>>            Set psCaption to "Login"
29310>>>            Set pbServerOnClick to True
29311>>>                        
29311>>>            Procedure OnClick
29314>>>                Send DoLogin
29315>>>            End_Procedure
29316>>>            
29316>>>        End_Object
29317>>>        
29317>>>    End_Object
29318>>>    
29318>>>    Procedure DoLogin
29321>>>        String sLoginName sPassword
29321>>>        Boolean bResult
29321>>>        Handle hoDefaultView
29321>>>        
29321>>>        WebGet psValue of oLoginName to sLoginName
29322>>>        WebGet psValue of oPassword to sPassword
29323>>>        
29323>>>        Get UserLogin of ghoWebSessionManager sLoginName sPassword to bResult
29324>>>        
29324>>>        If (bResult) Begin
29326>>>            Send Hide of oLoginDialog
29327>>>            Get GetDefaultView to hoDefaultView
29328>>>            If (hoDefaultView > 0) Begin
29330>>>                Send Show of hoDefaultView
29331>>>            End
29331>>>>
29331>>>            
29331>>>            // clear the login values. we don't want to return the login id & password as synchronized properties....
29331>>>            WebSet psValue of oLoginName to ""
29332>>>            WebSet psValue of oPassword  to ""
29333>>>            WebSet pbVisible of oWarning to False
29334>>>        End
29334>>>>
29334>>>        Else Begin
29335>>>            WebSet pbVisible of oWarning to True
29336>>>        End
29336>>>>
29336>>>    End_Procedure
29337>>>    
29337>>>    
29337>>>    Set pbServerOnSubmit to True
29338>>>    Procedure OnSubmit
29341>>>         Send DoLogin
29342>>>    End_Procedure
29343>>>End_Object
29344>    Use WebResourceManager.wo
Including file: WebResourceManager.wo    (C:\DojoManager\AppSrc\WebResourceManager.wo)
29344>>>Use cWebResourceManager.pkg
29344>>>
29344>>>Object oWebResourceManager is a cWebResourceManager
29346>>>End_Object
29347>    Use DojoEntry.wo
Including file: DojoEntry.wo    (C:\DojoManager\AppSrc\DojoEntry.wo)
29347>>>// C:\DojoManager\AppSrc\DojoEntry.wo
29347>>>// Dojo Entry
29347>>>//
29347>>>
29347>>>Use cWebView.pkg
29347>>>Use cWebPanel.pkg
29347>>>Use cWebForm.pkg
29347>>>Use cWebEdit.pkg
29347>>>Use cWebGrid.pkg
29347>>>Use cWebColumn.pkg
29347>>>
29347>>>Use cDojoDataDictionary.dd
Including file: cDojoDataDictionary.dd    (C:\DojoManager\DDSrc\cDojoDataDictionary.dd)
29347>>>>>Use DataDict.pkg
29347>>>>>
29347>>>>>Open Dojo
Including file: Dojo.fd    (C:\DojoManager\DDSrc\Dojo.fd)
29349>>>>>Open Members
Including file: Members.fd    (C:\DojoManager\DDSrc\Members.fd)
29351>>>>>Open Settings
Including file: Settings.fd    (C:\DojoManager\DDSrc\Settings.fd)
29353>>>>>Open Seminars
Including file: Seminars.fd    (C:\DojoManager\DDSrc\Seminars.fd)
29355>>>>>
29355>>>>>Register_Object oDojoWebLookup
29355>>>>>Register_Object oTeachersWebLookup
29355>>>>>
29355>>>>>Class cDojoDataDictionary is a DataDictionary
29356>>>>>    
29356>>>>>    Procedure Construct_Object
29358>>>>>        Forward Send Construct_Object
29360>>>>>        Set Main_File to Dojo.File_Number
29361>>>>>
29361>>>>>        Set Add_System_File to Settings.File_Number DD_Lock_On_All
29362>>>>>        Set Add_Client_File to Seminars.File_Number
29363>>>>>
29363>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
29364>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
29365>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
29366>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
29367>>>>>
29367>>>>>        Set Field_Auto_Increment Field Dojo.Dojo to File_Field Settings.DojoID
29368>>>>>        Set Field_WebPrompt_Object Field Dojo.Dojo to oDojoWebLookup
29369>>>>>
29369>>>>>        Set Field_WebPrompt_Object Field Dojo.Name to oDojoWebLookup
29370>>>>>
29370>>>>>        Set Field_WebPrompt_Object Field Dojo.DojoCho to oTeachersWebLookup
29371>>>>>
29371>>>>>    End_Procedure
29372>>>>>
29372>>>>>    Procedure Update
29374>>>>>        Forward Send Update
29376>>>>>        If (Dojo.Main) Begin //main dojo
29378>>>>>            Reread Settings
29382>>>>>            Move Dojo.Dojo to Settings.MainDojo
29383>>>>>            SaveRecord Settings
29384>>>>>            Unlock
29385>>>>>>
29385>>>>>        End
29385>>>>>>
29385>>>>>    End_Procedure
29386>>>>>
29386>>>>>    Procedure Backout
29388>>>>>        Forward Send Backout
29390>>>>>        Reread Settings
29394>>>>>        Move 0 to Settings.MainDojo 
29395>>>>>        Saverecord Settings
29396>>>>>        Unlock
29397>>>>>>
29397>>>>>    End_Procedure
29398>>>>>
29398>>>>>End_Class
29399>>>>>
29399>>>>>Use TeachersWebLookup.wo
Including file: TeachersWebLookup.wo    (C:\DojoManager\AppSrc\TeachersWebLookup.wo)
29399>>>>>>>// C:\DojoManager\AppSrc\TeachersWebLookup.wo
29399>>>>>>>// Teachers Lookup List
29399>>>>>>>//
29399>>>>>>>
29399>>>>>>>Use cWebModalDialog
29399>>>>>>>Use cWebPanel.pkg
29399>>>>>>>Use cWebButton.pkg
29399>>>>>>>Use cWebPromptList.pkg
29399>>>>>>>Use cWebColumn.pkg
29399>>>>>>>
29399>>>>>>>Use cTeachersDataDictionary.dd
Including file: cTeachersDataDictionary.dd    (C:\DojoManager\DDSrc\cTeachersDataDictionary.dd)
29399>>>>>>>>>Use DataDict.pkg
29399>>>>>>>>>
29399>>>>>>>>>Open Teachers
Including file: Teachers.fd    (C:\DojoManager\DDSrc\Teachers.fd)
29401>>>>>>>>>Open MemberRanks
Including file: MemberRanks.fd    (C:\DojoManager\DDSrc\MemberRanks.fd)
29403>>>>>>>>>Open Settings
29405>>>>>>>>>Open SeminarAttendees
Including file: SeminarAttendees.fd    (C:\DojoManager\DDSrc\SeminarAttendees.fd)
29407>>>>>>>>>
29407>>>>>>>>>Object InstructorTypes is a CodeValidationTable
29409>>>>>>>>>    Set Type_Value to "INSTRTYPES"
29410>>>>>>>>>End_Object
29411>>>>>>>>>
29411>>>>>>>>>Register_Object oTeachersWebLookup
29411>>>>>>>>>
29411>>>>>>>>>Class cTeachersDataDictionary is a DataDictionary
29412>>>>>>>>>    
29412>>>>>>>>>    Procedure Construct_Object
29414>>>>>>>>>        Forward Send Construct_Object
29416>>>>>>>>>        Set Main_File to Teachers.File_Number
29417>>>>>>>>>
29417>>>>>>>>>        Set Add_System_File to Settings.File_Number DD_Lock_On_All
29418>>>>>>>>>
29418>>>>>>>>>        Set Add_Client_File to MemberRanks.File_Number
29419>>>>>>>>>
29419>>>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
29420>>>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
29421>>>>>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
29422>>>>>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
29423>>>>>>>>>
29423>>>>>>>>>        Set Field_WebPrompt_Object Field Teachers.Instructor to oTeachersWebLookup
29424>>>>>>>>>        Set Field_Auto_Increment Field Teachers.Instructor to File_Field Settings.InstructorsID
29425>>>>>>>>>
29425>>>>>>>>>        Set Field_WebPrompt_Object Field Teachers.Name to oTeachersWebLookup
29426>>>>>>>>>
29426>>>>>>>>>        Set Field_Value_Table Field Teachers.Type to InstructorTypes
29427>>>>>>>>>
29427>>>>>>>>>    End_Procedure
29428>>>>>>>>>
29428>>>>>>>>>End_Class
29429>>>>>>>>>
29429>>>>>>>>>Use TeachersWebLookup.wo
29429>>>>>>>
29429>>>>>>>Object oTeachersWebLookup is a cWebModalDialog
29431>>>>>>>    Set piColumnCount to 12
29432>>>>>>>    Set psCaption to "Teachers Lookup List"
29433>>>>>>>    Set piWidth to 700
29434>>>>>>>    Set piHeight to 400
29435>>>>>>>
29435>>>>>>>    Object oTeachers_DD is a cTeachersDataDictionary
29437>>>>>>>    End_Object 
29438>>>>>>>
29438>>>>>>>    Set Main_DD To oTeachers_DD
29439>>>>>>>    Set Server  To oTeachers_DD
29440>>>>>>>
29440>>>>>>>
29440>>>>>>>    Object oWebMainPanel is a cWebPanel
29442>>>>>>>        Set piColumnCount to 12
29443>>>>>>>
29443>>>>>>>        Object oPromptList is a cWebPromptList
29445>>>>>>>            Set pbFillHeight to True
29446>>>>>>>            Set piColumnSpan to 12
29447>>>>>>>
29447>>>>>>>            Object oTeachersName is a cWebColumn
29449>>>>>>>                Entry_Item Teachers.Name
29450>>>>>>>                Set psCaption to "Name"
29451>>>>>>>                Set piWidth to 600
29452>>>>>>>            End_Object 
29453>>>>>>>
29453>>>>>>>            Object oTeachersType is a cWebColumn
29455>>>>>>>                Entry_Item Teachers.Type
29456>>>>>>>                Set psCaption to "Type"
29457>>>>>>>                Set piWidth to 50
29458>>>>>>>            End_Object 
29459>>>>>>>        End_Object 
29460>>>>>>>
29460>>>>>>>        Object oOkButton is a cWebButton
29462>>>>>>>            Set psCaption to "OK"
29463>>>>>>>            Set piColumnSpan to 2
29464>>>>>>>            Set piColumnIndex to 6
29465>>>>>>>
29465>>>>>>>            Procedure OnClick
29468>>>>>>>                Send Ok of oPromptList
29469>>>>>>>            End_Procedure
29470>>>>>>>
29470>>>>>>>        End_Object 
29471>>>>>>>
29471>>>>>>>        Object oCancelButton is a cWebButton
29473>>>>>>>            Set psCaption to "Cancel"
29474>>>>>>>            Set piColumnSpan to 2
29475>>>>>>>            Set piColumnIndex to 8
29476>>>>>>>            Procedure OnClick
29479>>>>>>>                Send Cancel of oPromptList
29480>>>>>>>            End_Procedure
29481>>>>>>>
29481>>>>>>>        End_Object 
29482>>>>>>>
29482>>>>>>>        Object oSearchButton is a cWebButton
29484>>>>>>>            Set psCaption to "Search..."
29485>>>>>>>            Set piColumnSpan to 2
29486>>>>>>>            Set piColumnIndex to 10
29487>>>>>>>
29487>>>>>>>            Procedure OnClick
29490>>>>>>>                Send Search of oPromptList
29491>>>>>>>            End_Procedure
29492>>>>>>>
29492>>>>>>>        End_Object 
29493>>>>>>>    End_Object 
29494>>>>>>>
29494>>>>>>>    Set pbServerOnShow to True
29495>>>>>>>    Procedure OnShow 
29498>>>>>>>        Send InitializePromptList of oPromptList
29499>>>>>>>    End_Procedure 
29500>>>>>>>
29500>>>>>>>    Set pbServerOnSubmit to True
29501>>>>>>>    Procedure OnSubmit 
29504>>>>>>>        Send Ok of oPromptList
29505>>>>>>>    End_Procedure 
29506>>>>>>>
29506>>>>>>>End_Object 
29507>>>>>Use DojoWebLookup.wo
Including file: DojoWebLookup.wo    (C:\DojoManager\AppSrc\DojoWebLookup.wo)
29507>>>>>>>// C:\DojoManager\AppSrc\DojoWebLookup.wo
29507>>>>>>>// Dojo Lookup List
29507>>>>>>>//
29507>>>>>>>
29507>>>>>>>Use cWebModalDialog
29507>>>>>>>Use cWebPanel.pkg
29507>>>>>>>Use cWebButton.pkg
29507>>>>>>>Use cWebPromptList.pkg
29507>>>>>>>Use cWebColumn.pkg
29507>>>>>>>
29507>>>>>>>Use cDojoDataDictionary.dd
29507>>>>>>>
29507>>>>>>>Object oDojoWebLookup is a cWebModalDialog
29509>>>>>>>    Set piColumnCount to 12
29510>>>>>>>    Set psCaption to "Dojo Lookup List"
29511>>>>>>>    Set piWidth to 700
29512>>>>>>>    Set piHeight to 400
29513>>>>>>>
29513>>>>>>>    Object oDojo_DD is a cDojoDataDictionary
29515>>>>>>>    End_Object 
29516>>>>>>>
29516>>>>>>>    Set Main_DD To oDojo_DD
29517>>>>>>>    Set Server  To oDojo_DD
29518>>>>>>>
29518>>>>>>>
29518>>>>>>>    Object oWebMainPanel is a cWebPanel
29520>>>>>>>        Set piColumnCount to 12
29521>>>>>>>
29521>>>>>>>        Object oPromptList is a cWebPromptList
29523>>>>>>>            Set pbFillHeight to True
29524>>>>>>>            Set piColumnSpan to 12
29525>>>>>>>
29525>>>>>>>            Object oDojoName is a cWebColumn
29527>>>>>>>                Entry_Item Dojo.Name
29528>>>>>>>                Set psCaption to "Name"
29529>>>>>>>                Set piWidth to 600
29530>>>>>>>            End_Object 
29531>>>>>>>
29531>>>>>>>            Object oDojoDojoCho is a cWebColumn
29533>>>>>>>                Entry_Item Dojo.DojoCho
29534>>>>>>>                Set psCaption to "DojoCho"
29535>>>>>>>                Set piWidth to 78
29536>>>>>>>            End_Object 
29537>>>>>>>        End_Object 
29538>>>>>>>
29538>>>>>>>        Object oOkButton is a cWebButton
29540>>>>>>>            Set psCaption to "OK"
29541>>>>>>>            Set piColumnSpan to 2
29542>>>>>>>            Set piColumnIndex to 6
29543>>>>>>>
29543>>>>>>>            Procedure OnClick
29546>>>>>>>                Send Ok of oPromptList
29547>>>>>>>            End_Procedure
29548>>>>>>>
29548>>>>>>>        End_Object 
29549>>>>>>>
29549>>>>>>>        Object oCancelButton is a cWebButton
29551>>>>>>>            Set psCaption to "Cancel"
29552>>>>>>>            Set piColumnSpan to 2
29553>>>>>>>            Set piColumnIndex to 8
29554>>>>>>>            Procedure OnClick
29557>>>>>>>                Send Cancel of oPromptList
29558>>>>>>>            End_Procedure
29559>>>>>>>
29559>>>>>>>        End_Object 
29560>>>>>>>
29560>>>>>>>        Object oSearchButton is a cWebButton
29562>>>>>>>            Set psCaption to "Search..."
29563>>>>>>>            Set piColumnSpan to 2
29564>>>>>>>            Set piColumnIndex to 10
29565>>>>>>>
29565>>>>>>>            Procedure OnClick
29568>>>>>>>                Send Search of oPromptList
29569>>>>>>>            End_Procedure
29570>>>>>>>
29570>>>>>>>        End_Object 
29571>>>>>>>    End_Object 
29572>>>>>>>
29572>>>>>>>    Set pbServerOnShow to True
29573>>>>>>>    Procedure OnShow 
29576>>>>>>>        Send InitializePromptList of oPromptList
29577>>>>>>>    End_Procedure 
29578>>>>>>>
29578>>>>>>>    Set pbServerOnSubmit to True
29579>>>>>>>    Procedure OnSubmit 
29582>>>>>>>        Send Ok of oPromptList
29583>>>>>>>    End_Procedure 
29584>>>>>>>
29584>>>>>>>End_Object 
29585>>>Use cMembersDataDictionary.dd
Including file: cMembersDataDictionary.dd    (C:\DojoManager\DDSrc\cMembersDataDictionary.dd)
29585>>>>>Use DataDict.pkg
29585>>>>>
29585>>>>>Open Members
29587>>>>>Open Dojo
29589>>>>>Open MemberRanks
29591>>>>>Open Settings
29593>>>>>Open Teachers
29595>>>>>Open SeminarAttendees
29597>>>>>Open Payments
Including file: Payments.fd    (C:\DojoManager\DDSrc\Payments.fd)
29599>>>>>
29599>>>>>Object MemberTypes is a CodeValidationTable
29601>>>>>    Set Type_Value to "MEMBTYPES"
29602>>>>>End_Object
29603>>>>>
29603>>>>>Object JinenkanMemberTypes is a CodeValidationTable
29605>>>>>    Set Type_Value to "JMEMBTYPES"
29606>>>>>End_Object
29607>>>>>
29607>>>>>Object PaymentMonth is a DescriptionValidationTable
29609>>>>>    Procedure Fill_List
29612>>>>>        Forward Send Fill_List
29614>>>>>        Send Add_Table_Value "0" "Guest"
29615>>>>>        Send Add_Table_Value "1" "January"
29616>>>>>        Send Add_Table_Value "2" "February"
29617>>>>>        Send Add_Table_Value "3" "March"
29618>>>>>        Send Add_Table_Value "4" "April"
29619>>>>>        Send Add_Table_Value "5" "May"
29620>>>>>        Send Add_Table_Value "6" "June"
29621>>>>>        Send Add_Table_Value "7" "July"
29622>>>>>        Send Add_Table_Value "8" "August"
29623>>>>>        Send Add_Table_Value "9" "September"
29624>>>>>        Send Add_Table_Value "10" "October"
29625>>>>>        Send Add_Table_Value "11" "November"
29626>>>>>        Send Add_Table_Value "12" "December"
29627>>>>>    End_Procedure
29628>>>>>End_Object
29629>>>>>
29629>>>>>Object BikenRanks is a DescriptionValidationTable
29631>>>>>    Procedure Fill_List
29634>>>>>        Forward Send Fill_List
29636>>>>>        Send Add_Table_Value "0" "No rank"
29637>>>>>        Send Add_Table_Value "1" "Chi no maki"
29638>>>>>        Send Add_Table_Value "2" "Mizu no maki"
29639>>>>>        Send Add_Table_Value "3" "Hi no maki"
29640>>>>>        Send Add_Table_Value "4" "Fu no maki"
29641>>>>>        Send Add_Table_Value "5" "Ku no maki"
29642>>>>>        Send Add_Table_Value "6" "Menkyo Kaiden"
29643>>>>>    End_Procedure
29644>>>>>End_Object
29645>>>>>
29645>>>>>Object NitoRanks is a DescriptionValidationTable
29647>>>>>    Procedure Fill_List
29650>>>>>        Forward Send Fill_List
29652>>>>>        Send Add_Table_Value "0" "No rank"
29653>>>>>        Send Add_Table_Value "1" "Kiso no maki"
29654>>>>>        Send Add_Table_Value "2" "Ten no maki"
29655>>>>>        Send Add_Table_Value "3" "Chi no maki"
29656>>>>>        Send Add_Table_Value "4" "Menkyo Kaiden"
29657>>>>>    End_Procedure
29658>>>>>End_Object
29659>>>>>
29659>>>>>Object TantoRanks is a DescriptionValidationTable
29661>>>>>    Procedure Fill_List
29664>>>>>        Forward Send Fill_List
29666>>>>>        Send Add_Table_Value "0" "No rank"
29667>>>>>        Send Add_Table_Value "1" "Kiso no maki"
29668>>>>>        Send Add_Table_Value "2" "Kihon gata"
29669>>>>>        Send Add_Table_Value "3" "Sabaki gata"
29670>>>>>        Send Add_Table_Value "4" "Menkyo Kaiden"
29671>>>>>    End_Procedure
29672>>>>>End_Object
29673>>>>>
29673>>>>>Object JutteRanks is a DescriptionValidationTable
29675>>>>>    Procedure Fill_List
29678>>>>>        Forward Send Fill_List
29680>>>>>        Send Add_Table_Value "0" "No rank"
29681>>>>>        Send Add_Table_Value "1" "Kiso no maki"
29682>>>>>        Send Add_Table_Value "2" "Kihon gata"
29683>>>>>        Send Add_Table_Value "3" "Sabaki gata"
29684>>>>>        Send Add_Table_Value "4" "Menkyo Kaiden"
29685>>>>>    End_Procedure
29686>>>>>End_Object
29687>>>>>
29687>>>>>Object KusariRanks is a DescriptionValidationTable
29689>>>>>    Procedure Fill_List
29692>>>>>        Forward Send Fill_List
29694>>>>>        Send Add_Table_Value "0" "No rank"
29695>>>>>        Send Add_Table_Value "1" "Kiso no maki"
29696>>>>>        Send Add_Table_Value "2" "Sabaki gata"
29697>>>>>        Send Add_Table_Value "3" "Menkyo Kaiden"
29698>>>>>    End_Procedure
29699>>>>>End_Object
29700>>>>>
29700>>>>>Object KobudoRanks is a DescriptionValidationTable
29702>>>>>    Procedure Fill_List
29705>>>>>        Forward Send Fill_List
29707>>>>>        Send Add_Table_Value "0" "Mukyu"
29708>>>>>        Send Add_Table_Value "1" "Rokukyu"
29709>>>>>        Send Add_Table_Value "2" "Gokyu"
29710>>>>>        Send Add_Table_Value "3" "Yonkyu"
29711>>>>>        Send Add_Table_Value "4" "Sankyu"
29712>>>>>        Send Add_Table_Value "5" "Nikyu"
29713>>>>>        Send Add_Table_Value "6" "Ikkyu"
29714>>>>>        Send Add_Table_Value "7" "Shodan"
29715>>>>>        Send Add_Table_Value "8" "Nidan"
29716>>>>>        Send Add_Table_Value "9" "Sandan"
29717>>>>>        Send Add_Table_Value "10" "Yondan"
29718>>>>>        Send Add_Table_Value "11" "Godan"
29719>>>>>        Send Add_Table_Value "12" "Rokudan"
29720>>>>>        Send Add_Table_Value "13" "Shichidan"
29721>>>>>        Send Add_Table_Value "14" "Hachidan"
29722>>>>>        Send Add_Table_Value "15" "Kudan"
29723>>>>>    End_Procedure
29724>>>>>End_Object
29725>>>>>
29725>>>>>Register_Object oMembersWebLookup
29725>>>>>
29725>>>>>Register_Function ValidateMembersEmail Integer iColumn String sValue Returns Boolean
29725>>>>>
29725>>>>>Register_Object oRanksWebLookup
29725>>>>>
29725>>>>>Class cMembersDataDictionary is a DataDictionary
29726>>>>>    
29726>>>>>    Procedure Construct_Object
29728>>>>>        Forward Send Construct_Object
29730>>>>>        Set Main_File to Members.File_Number
29731>>>>>
29731>>>>>        Set Add_System_File to Settings.File_Number DD_Lock_On_All
29732>>>>>
29732>>>>>        Set Add_Client_File to MemberRanks.File_Number
29733>>>>>
29733>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
29734>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
29735>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
29736>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
29737>>>>>        Set Field_WebPrompt_Object Field Members.Member to oMembersWebLookup
29738>>>>>
29738>>>>>        Set Field_WebPrompt_Object Field Members.Dojo to oMembersWebLookup
29739>>>>>
29739>>>>>        Set Field_WebPrompt_Object Field Members.Name to oMembersWebLookup
29740>>>>>        Set Field_Option Field Members.Name DD_REQUIRED to True
29741>>>>>
29741>>>>>        Set Field_Value_Table Field Members.MemberType to JinenkanMemberTypes
29742>>>>>        Set Field_Value_Table Field Members.PaymentDue to PaymentMonth
29743>>>>>
29743>>>>>        Set Field_Value_Table Field Members.Type to MemberTypes
29744>>>>>        Set Field_Option Field Members.Type DD_REQUIRED to True
29745>>>>>
29745>>>>>        Set Field_WebPrompt_Object Field Members.Rank to oRanksWebLookup
29746>>>>>        Set Field_Value_Table Field Members.Rank to KobudoRanks
29747>>>>>
29747>>>>>        Set Field_Value_Table Field Members.BikenRank to BikenRanks
29748>>>>>
29748>>>>>        Set Field_WebPrompt_Object Field Members.NitoRank to oRanksWebLookup
29749>>>>>        Set Field_Value_Table Field Members.NitoRank to NitoRanks
29750>>>>>
29750>>>>>        Set Field_WebPrompt_Object Field Members.TantoRank to oRanksWebLookup
29751>>>>>        Set Field_Value_Table Field Members.TantoRank to TantoRanks
29752>>>>>
29752>>>>>        Set Field_WebPrompt_Object Field Members.JutteRank to oRanksWebLookup
29753>>>>>        Set Field_Value_Table Field Members.JutteRank to JutteRanks
29754>>>>>
29754>>>>>        Set Field_WebPrompt_Object Field Members.KusariRank to oRanksWebLookup
29755>>>>>        Set Field_Value_Table Field Members.KusariRank to KusariRanks
29756>>>>>
29756>>>>>        Set Field_Option Field Members.Email DD_REQUIRED to True
29757>>>>>        Set Field_Validate_msg Field Members.Email to get_ValidateMembersEmail
29758>>>>>
29758>>>>>    End_Procedure
29759>>>>>
29759>>>>>    Function ValidateMembersEmail Integer iColumn String sValue Returns Boolean
29761>>>>>        If (not(sValue contains ".") or (not(sValue contains "@"))) Begin 
29763>>>>>            Send UserError  "This is not a valid e-mail address!"
29764>>>>>            Function_Return True
29765>>>>>        End
29765>>>>>>
29765>>>>>    End_Function
29766>>>>>
29766>>>>>    Procedure Update
29768>>>>>        Forward Send Update
29770>>>>>        If (Members.Member = 0) Begin //no member no set
29772>>>>>            If (Members.Type = 0) Begin //guest member
29774>>>>>                Move (Settings.GuestMembersID + 1) to Members.Member
29775>>>>>                Reread Settings
29779>>>>>                Move Members.Member to Settings.GuestMembersID
29780>>>>>                Saverecord Settings
29781>>>>>                Unlock
29782>>>>>>
29782>>>>>            End
29782>>>>>>
29782>>>>>        End
29782>>>>>>
29782>>>>>        If (Members.Dojo = 0) Begin 
29784>>>>>            Move 99 to Members.Dojo
29785>>>>>        End
29785>>>>>>
29785>>>>>    End_Procedure
29786>>>>>
29786>>>>>End_Class
29787>>>>>
29787>>>>>Use MembersWebLookup.wo
Including file: MembersWebLookup.wo    (C:\DojoManager\AppSrc\MembersWebLookup.wo)
29787>>>>>>>// C:\DojoManager\AppSrc\MembersWebLookup.wo
29787>>>>>>>// Members Lookup List
29787>>>>>>>//
29787>>>>>>>
29787>>>>>>>Use cWebModalDialog
29787>>>>>>>Use cWebPanel.pkg
29787>>>>>>>Use cWebButton.pkg
29787>>>>>>>Use cWebPromptList.pkg
29787>>>>>>>Use cWebColumn.pkg
29787>>>>>>>
29787>>>>>>>Use cDojoDataDictionary.dd
29787>>>>>>>Use cMembersDataDictionary.dd
29787>>>>>>>
29787>>>>>>>Object oMembersWebLookup is a cWebModalDialog
29789>>>>>>>    Set piColumnCount to 12
29790>>>>>>>    Set psCaption to "Members Lookup List"
29791>>>>>>>    Set piWidth to 700
29792>>>>>>>    Set piHeight to 400
29793>>>>>>>
29793>>>>>>>    Object oDojo_DD is a cDojoDataDictionary
29795>>>>>>>    End_Object 
29796>>>>>>>
29796>>>>>>>    Object oMembers_DD is a cMembersDataDictionary
29798>>>>>>>        Set DDO_Server To oDojo_DD
29799>>>>>>>    End_Object 
29800>>>>>>>
29800>>>>>>>    Set Main_DD To oMembers_DD
29801>>>>>>>    Set Server  To oMembers_DD
29802>>>>>>>
29802>>>>>>>
29802>>>>>>>    Object oWebMainPanel is a cWebPanel
29804>>>>>>>        Set piColumnCount to 12
29805>>>>>>>
29805>>>>>>>        Object oPromptList is a cWebPromptList
29807>>>>>>>            Set pbFillHeight to True
29808>>>>>>>            Set piColumnSpan to 12
29809>>>>>>>
29809>>>>>>>            Object oMembersName is a cWebColumn
29811>>>>>>>                Entry_Item Members.Name
29812>>>>>>>                Set psCaption to "Name"
29813>>>>>>>                Set piWidth to 600
29814>>>>>>>            End_Object 
29815>>>>>>>
29815>>>>>>>            Object oDojoDojo is a cWebColumn
29817>>>>>>>                Entry_Item Dojo.Dojo
29818>>>>>>>                Set psCaption to "Dojo"
29819>>>>>>>                Set piWidth to 144
29820>>>>>>>            End_Object 
29821>>>>>>>        End_Object 
29822>>>>>>>
29822>>>>>>>        Object oOkButton is a cWebButton
29824>>>>>>>            Set psCaption to "OK"
29825>>>>>>>            Set piColumnSpan to 2
29826>>>>>>>            Set piColumnIndex to 6
29827>>>>>>>
29827>>>>>>>            Procedure OnClick
29830>>>>>>>                Send Ok of oPromptList
29831>>>>>>>            End_Procedure
29832>>>>>>>
29832>>>>>>>        End_Object 
29833>>>>>>>
29833>>>>>>>        Object oCancelButton is a cWebButton
29835>>>>>>>            Set psCaption to "Cancel"
29836>>>>>>>            Set piColumnSpan to 2
29837>>>>>>>            Set piColumnIndex to 8
29838>>>>>>>            Procedure OnClick
29841>>>>>>>                Send Cancel of oPromptList
29842>>>>>>>            End_Procedure
29843>>>>>>>
29843>>>>>>>        End_Object 
29844>>>>>>>
29844>>>>>>>        Object oSearchButton is a cWebButton
29846>>>>>>>            Set psCaption to "Search..."
29847>>>>>>>            Set piColumnSpan to 2
29848>>>>>>>            Set piColumnIndex to 10
29849>>>>>>>
29849>>>>>>>            Procedure OnClick
29852>>>>>>>                Send Search of oPromptList
29853>>>>>>>            End_Procedure
29854>>>>>>>
29854>>>>>>>        End_Object 
29855>>>>>>>    End_Object 
29856>>>>>>>
29856>>>>>>>    Set pbServerOnShow to True
29857>>>>>>>    Procedure OnShow 
29860>>>>>>>        Send InitializePromptList of oPromptList
29861>>>>>>>    End_Procedure 
29862>>>>>>>
29862>>>>>>>    Set pbServerOnSubmit to True
29863>>>>>>>    Procedure OnSubmit 
29866>>>>>>>        Send Ok of oPromptList
29867>>>>>>>    End_Procedure 
29868>>>>>>>
29868>>>>>>>End_Object 
29869>>>Use cTeachersDataDictionary.dd
29869>>>Use cSeminarsDataDictionary.dd
Including file: cSeminarsDataDictionary.dd    (C:\DojoManager\DDSrc\cSeminarsDataDictionary.dd)
29869>>>>>Use DataDict.pkg
29869>>>>>
29869>>>>>Open Seminars
29871>>>>>Open Dojo
29873>>>>>Open Settings
29875>>>>>Open SeminarAttendees
29877>>>>>
29877>>>>>Class cSeminarsDataDictionary is a DataDictionary
29878>>>>>    
29878>>>>>    Procedure Construct_Object
29880>>>>>        Forward Send Construct_Object
29882>>>>>        Set Main_File to Seminars.File_Number
29883>>>>>
29883>>>>>        Set Add_Client_File to SeminarAttendees.File_Number
29884>>>>>
29884>>>>>        Set Add_System_File to Settings.File_Number DD_Lock_On_All
29885>>>>>
29885>>>>>        Set Add_Server_File to Dojo.File_Number
29886>>>>>
29886>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
29887>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
29888>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
29889>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
29890>>>>>
29890>>>>>        Set Field_Auto_Increment Field Seminars.Seminar to File_Field Dojo.SeminarID
29891>>>>>
29891>>>>>    End_Procedure
29892>>>>>
29892>>>>>End_Class
29893>>>Use cMemberRanksDataDictionary.dd
Including file: cMemberRanksDataDictionary.dd    (C:\DojoManager\DDSrc\cMemberRanksDataDictionary.dd)
29893>>>>>Use DataDict.pkg
29893>>>>>
29893>>>>>Open MemberRanks
29895>>>>>Open Members
29897>>>>>Open Teachers
29899>>>>>
29899>>>>>Object RankType is a DescriptionValidationTable
29901>>>>>    Procedure Fill_List
29904>>>>>        Forward Send Fill_List
29906>>>>>        Send Add_Table_Value "1" "Jissen Kobudo"
29907>>>>>        Send Add_Table_Value "2" "Jinen Ryu Bikenjutsu"
29908>>>>>        Send Add_Table_Value "3" "Jinen Ryu Nitojutusu"
29909>>>>>        Send Add_Table_Value "4" "Jinen Ryu Tantojutsu"
29910>>>>>        Send Add_Table_Value "5" "Jinen Ryu Juttejutsu"
29911>>>>>        Send Add_Table_Value "6" "Jinen Ryu Kusarifundojutsu"
29912>>>>>    End_Procedure
29913>>>>>End_Object
29914>>>>>
29914>>>>>Object BikenRanks is a DescriptionValidationTable
29916>>>>>    Procedure Fill_List
29919>>>>>        Forward Send Fill_List
29921>>>>>        Send Add_Table_Value "1" "Chi no maki"
29922>>>>>        Send Add_Table_Value "2" "Mizu no maki"
29923>>>>>        Send Add_Table_Value "3" "Hi no maki"
29924>>>>>        Send Add_Table_Value "4" "Fu no maki"
29925>>>>>        Send Add_Table_Value "5" "Ku no maki"
29926>>>>>        Send Add_Table_Value "6" "Menkyo Kaiden"
29927>>>>>    End_Procedure
29928>>>>>End_Object
29929>>>>>
29929>>>>>Object NitoRanks is a DescriptionValidationTable
29931>>>>>    Procedure Fill_List
29934>>>>>        Forward Send Fill_List
29936>>>>>        Send Add_Table_Value "1" "Kiso no maki"
29937>>>>>        Send Add_Table_Value "2" "Ten no maki"
29938>>>>>        Send Add_Table_Value "3" "Chi no maki"
29939>>>>>        Send Add_Table_Value "4" "Menkyo Kaiden"
29940>>>>>    End_Procedure
29941>>>>>End_Object
29942>>>>>
29942>>>>>Object TantoRanks is a DescriptionValidationTable
29944>>>>>    Procedure Fill_List
29947>>>>>        Forward Send Fill_List
29949>>>>>        Send Add_Table_Value "1" "Kiso no maki"
29950>>>>>        Send Add_Table_Value "2" "Kihon gata"
29951>>>>>        Send Add_Table_Value "3" "Sabaki gata"
29952>>>>>        Send Add_Table_Value "4" "Menkyo Kaiden"
29953>>>>>    End_Procedure
29954>>>>>End_Object
29955>>>>>
29955>>>>>Object JutteRanks is a DescriptionValidationTable
29957>>>>>    Procedure Fill_List
29960>>>>>        Forward Send Fill_List
29962>>>>>        Send Add_Table_Value "1" "Kiso no maki"
29963>>>>>        Send Add_Table_Value "2" "Kihon gata"
29964>>>>>        Send Add_Table_Value "3" "Sabaki gata"
29965>>>>>        Send Add_Table_Value "4" "Menkyo Kaiden"
29966>>>>>    End_Procedure
29967>>>>>End_Object
29968>>>>>
29968>>>>>Object KusariRanks is a DescriptionValidationTable
29970>>>>>    Procedure Fill_List
29973>>>>>        Forward Send Fill_List
29975>>>>>        Send Add_Table_Value "1" "Kiso no maki"
29976>>>>>        Send Add_Table_Value "2" "Sabaki gata"
29977>>>>>        Send Add_Table_Value "3" "Menkyo Kaiden"
29978>>>>>    End_Procedure
29979>>>>>End_Object
29980>>>>>
29980>>>>>Object KobudoRanks is a DescriptionValidationTable
29982>>>>>    Procedure Fill_List
29985>>>>>        Forward Send Fill_List
29987>>>>>        Send Add_Table_Value "1" "Rokukyu"
29988>>>>>        Send Add_Table_Value "2" "Gokyu"
29989>>>>>        Send Add_Table_Value "3" "Yonkyu"
29990>>>>>        Send Add_Table_Value "4" "Sankyu"
29991>>>>>        Send Add_Table_Value "5" "Nikyu"
29992>>>>>        Send Add_Table_Value "6" "Ikkyu"
29993>>>>>        Send Add_Table_Value "7" "Shodan"
29994>>>>>        Send Add_Table_Value "8" "Nidan"
29995>>>>>        Send Add_Table_Value "9" "Sandan"
29996>>>>>        Send Add_Table_Value "10" "Yondan"
29997>>>>>        Send Add_Table_Value "11" "Godan"
29998>>>>>        Send Add_Table_Value "12" "Rokudan"
29999>>>>>        Send Add_Table_Value "13" "Shichidan"
30000>>>>>        Send Add_Table_Value "14" "Hachidan"
30001>>>>>        Send Add_Table_Value "15" "Kudan"
30002>>>>>    End_Procedure
30003>>>>>End_Object
30004>>>>>Object BikenRanks is a DescriptionValidationTable
30006>>>>>    Procedure Fill_List
30009>>>>>        Forward Send Fill_List
30011>>>>>        Send Add_Table_Value "1" "Chi no maki"
30012>>>>>        Send Add_Table_Value "2" "Mizu no maki"
30013>>>>>        Send Add_Table_Value "3" "Hi no maki"
30014>>>>>        Send Add_Table_Value "4" "Fu no maki"
30015>>>>>        Send Add_Table_Value "5" "Ku no maki"
30016>>>>>        Send Add_Table_Value "6" "Menkyo Kaiden"
30017>>>>>    End_Procedure
30018>>>>>End_Object
30019>>>>>
30019>>>>>Object NitoRanks is a DescriptionValidationTable
30021>>>>>    Procedure Fill_List
30024>>>>>        Forward Send Fill_List
30026>>>>>        Send Add_Table_Value "1" "Kiso no maki"
30027>>>>>        Send Add_Table_Value "2" "Ten no maki"
30028>>>>>        Send Add_Table_Value "3" "Chi no maki"
30029>>>>>        Send Add_Table_Value "4" "Menkyo Kaiden"
30030>>>>>    End_Procedure
30031>>>>>End_Object
30032>>>>>
30032>>>>>Object TantoRanks is a DescriptionValidationTable
30034>>>>>    Procedure Fill_List
30037>>>>>        Forward Send Fill_List
30039>>>>>        Send Add_Table_Value "1" "Kiso no maki"
30040>>>>>        Send Add_Table_Value "2" "Kihon gata"
30041>>>>>        Send Add_Table_Value "3" "Sabaki gata"
30042>>>>>        Send Add_Table_Value "4" "Menkyo Kaiden"
30043>>>>>    End_Procedure
30044>>>>>End_Object
30045>>>>>
30045>>>>>Object JutteRanks is a DescriptionValidationTable
30047>>>>>    Procedure Fill_List
30050>>>>>        Forward Send Fill_List
30052>>>>>        Send Add_Table_Value "1" "Kiso no maki"
30053>>>>>        Send Add_Table_Value "2" "Kihon gata"
30054>>>>>        Send Add_Table_Value "3" "Sabaki gata"
30055>>>>>        Send Add_Table_Value "4" "Menkyo Kaiden"
30056>>>>>    End_Procedure
30057>>>>>End_Object
30058>>>>>
30058>>>>>Object KusariRanks is a DescriptionValidationTable
30060>>>>>    Procedure Fill_List
30063>>>>>        Forward Send Fill_List
30065>>>>>        Send Add_Table_Value "1" "Kiso no maki"
30066>>>>>        Send Add_Table_Value "2" "Sabaki gata"
30067>>>>>        Send Add_Table_Value "3" "Menkyo Kaiden"
30068>>>>>    End_Procedure
30069>>>>>End_Object
30070>>>>>
30070>>>>>Object KobudoRanks is a DescriptionValidationTable
30072>>>>>    Procedure Fill_List
30075>>>>>        Forward Send Fill_List
30077>>>>>        Send Add_Table_Value "1" "Rokukyu"
30078>>>>>        Send Add_Table_Value "2" "Gokyu"
30079>>>>>        Send Add_Table_Value "3" "Yonkyu"
30080>>>>>        Send Add_Table_Value "4" "Sankyu"
30081>>>>>        Send Add_Table_Value "5" "Nikyu"
30082>>>>>        Send Add_Table_Value "6" "Ikkyu"
30083>>>>>        Send Add_Table_Value "7" "Shodan"
30084>>>>>        Send Add_Table_Value "8" "Nidan"
30085>>>>>        Send Add_Table_Value "9" "Sandan"
30086>>>>>        Send Add_Table_Value "10" "Yondan"
30087>>>>>        Send Add_Table_Value "11" "Godan"
30088>>>>>        Send Add_Table_Value "12" "Rokudan"
30089>>>>>        Send Add_Table_Value "13" "Shichidan"
30090>>>>>        Send Add_Table_Value "14" "Hachidan"
30091>>>>>        Send Add_Table_Value "15" "Kudan"
30092>>>>>    End_Procedure
30093>>>>>End_Object
30094>>>>>
30094>>>>>Class cMemberRanksDataDictionary is a DataDictionary
30095>>>>>    
30095>>>>>    Procedure Construct_Object
30097>>>>>        Forward Send Construct_Object
30099>>>>>        Set Main_File to MemberRanks.File_Number
30100>>>>>        Set Add_Server_File to Teachers.File_Number
30101>>>>>        Set Add_Server_File to Members.File_Number
30102>>>>>
30102>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
30103>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
30104>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_AUTOFIND to True
30105>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
30106>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_AUTOFIND_GE to True
30107>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_AUTOFIND to True
30108>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_FINDREQ to True
30109>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
30110>>>>>
30110>>>>>        Set Field_Value_Table Field MemberRanks.Type to RankType
30111>>>>>
30111>>>>>        Set Field_Entry_msg Field MemberRanks.Rank to EnterMemberRanksRank
30112>>>>>
30112>>>>>    End_Procedure
30113>>>>>
30113>>>>>    Procedure Update
30115>>>>>        Forward Send Update
30117>>>>>    End_Procedure
30118>>>>>
30118>>>>>    Procedure EnterMemberRanksRank Integer iColumn Integer iValue
30120>>>>>        Integer iType
30120>>>>>        Get Field_Current_Value Field MemberRanks.Type to iType
30121>>>>>        If (iType = 1) Begin 
30123>>>>>            Set Field_Value_Table Field MemberRanks.Rank to KobudoRanks
30124>>>>>        End
30124>>>>>>
30124>>>>>       Else  If (iType = 2) Begin 
30127>>>>>            Set Field_Value_Table Field MemberRanks.Rank to BikenRanks
30128>>>>>        End
30128>>>>>>
30128>>>>>       Else  If (iType = 3) Begin 
30131>>>>>            Set Field_Value_Table Field MemberRanks.Rank to NitoRanks
30132>>>>>        End
30132>>>>>>
30132>>>>>       Else  If (iType = 4) Begin 
30135>>>>>            Set Field_Value_Table Field MemberRanks.Rank to TantoRanks
30136>>>>>        End
30136>>>>>>
30136>>>>>       Else  If (iType = 5) Begin 
30139>>>>>            Set Field_Value_Table Field MemberRanks.Rank to JutteRanks
30140>>>>>        End
30140>>>>>>
30140>>>>>       Else  If (iType = 6) Begin 
30143>>>>>            Set Field_Value_Table Field MemberRanks.Rank to KusariRanks
30144>>>>>        End
30144>>>>>>
30144>>>>>    End_Procedure
30145>>>>>
30145>>>>>End_Class
30146>>>Use cWebTabContainer.pkg
30146>>>Use cWebTabPage.pkg
30146>>>Use cWebButton.pkg
30146>>>Use cWebColumnImage.pkg
Including file: cWebColumnImage.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cWebColumnImage.pkg)
30146>>>>>Use cWebColumn_mixin.pkg
30146>>>>>Use cWebBaseDEO.pkg
30146>>>>>
30146>>>>>// Used to represent each column of a cWebGrid or cWebLookup control.
30146>>>>>Class cWebColumnImage is a cWebBaseDEO
30147>>>>>    Import_Class_Protocol cWebColumn_mixin
30148>>>>>    
30148>>>>>    Procedure Construct_Object
30150>>>>>        Forward Send Construct_Object
30152>>>>>        
30152>>>>>        Send Define_cWebColumn_Mixin
30153>>>>>                
30153>>>>>        Property String psImageUrl "" 
30156>>>>>        Property String psImageCSSClass ""
30159>>>>>        
30159>>>>>        Property Integer pePosition wiStretchHoriz //   Allows dynamic image positioning. Note that piImageWidth and piImageHeight must be set for this to work.
30162>>>>>        
30162>>>>>        Property Boolean pbDynamic False
30165>>>>>        Property Boolean pbImageByCSS False
30168>>>>>        
30168>>>>>        Property Integer piImageWidth 0
30171>>>>>        Property Integer piImageHeight 0
30174>>>>>        
30174>>>>>        Property Boolean pbServerOnClick False
30177>>>>>        Property String psClientOnClick ""
30180>>>>>        
30180>>>>>        Property String[] paImgOptions
30181>>>>>        
30181>>>>>        //  Sorting on a image column wouldn't make sense
30181>>>>>        Set pbSortable to False
30182>>>>>        
30182>>>>>        Set psJSClass to "df.WebColumnImage"
30183>>>>>    End_Procedure
30184>>>>> 
30184>>>>>    Procedure LoadGridCell tWebCell ByRef tCell
30186>>>>>        Boolean bMulti
30186>>>>>        String[] aEmpty
30187>>>>>        
30187>>>>>        Set paImgOptions to aEmpty
30188>>>>>        
30188>>>>>        Get pbDynamic to bMulti
30189>>>>>        If (bMulti) Begin
30191>>>>>            Send OnDefineImages
30192>>>>>            Get paImgOptions to tCell.aOptions
30193>>>>>        End
30193>>>>>>
30193>>>>>        
30193>>>>>        // Give a chance to add custom tooltips & CSS Classnames
30193>>>>>        Send OnDefineTooltip (&tCell.sTooltip)
30194>>>>>        Send OnDefineCssClass (&tCell.sCssClassName)
30195>>>>>    End_Procedure
30196>>>>>    
30196>>>>>    Procedure OnDefineImages
30198>>>>>        
30198>>>>>    End_Procedure
30199>>>>>    
30199>>>>>    Procedure OnClick String sImage String sRowId
30201>>>>>        
30201>>>>>    End_Procedure
30202>>>>>    
30202>>>>>    Procedure AddImage String sUrl
30204>>>>>        String[] aImages
30205>>>>>        
30205>>>>>        Get paImgOptions to aImages
30206>>>>>        
30206>>>>>        Move sUrl to aImages[SizeOfArray(aImages)]
30207>>>>>        
30207>>>>>        Set paImgOptions to aImages
30208>>>>>    End_Procedure
30209>>>>>    
30209>>>>>    Procedure End_Construct_Object
30211>>>>>        WebPublishProcedure OnClick
30212>>>>>        
30212>>>>>        Forward Send End_Construct_Object
30214>>>>>    End_Procedure
30215>>>>>
30215>>>>>End_Class
30216>>>Use cWebColumnCombo.pkg
30216>>>
30216>>>Object oDojo is a cWebView
30218>>>    Set piColumnCount to 12
30219>>>    Set psCaption to "Dojo Entry"
30220>>>    Set pbClearAfterSave to False
30221>>>    Set Verify_Save_msg to 0
30222>>>    Set pbServerOnShow to True
30223>>>    Delegate Set phoDefaultView to Self
30225>>>
30225>>>    Object oTeachers_DD is a cTeachersDataDictionary
30227>>>    End_Object
30228>>>
30228>>>    Object oDojo_DD is a cDojoDataDictionary
30230>>>        // this lets you save a new parent DD from within child DD
30230>>>        Set Allow_Foreign_New_Save_State to True
30231>>>    End_Object 
30232>>>
30232>>>    Object oSeminars_DD is a cSeminarsDataDictionary
30234>>>        Set Constrain_file to Dojo.File_number
30235>>>        Set DDO_Server to oDojo_DD
30236>>>    End_Object
30237>>>
30237>>>    Object oMembers_DD is a cMembersDataDictionary
30239>>>        Set pbUseDDRelates to True
30240>>>        Set Field_Related_FileField Field Members.Dojo to File_Field Dojo.Dojo
30241>>>        Set DDO_Server to oDojo_DD
30242>>>        Set Constrain_File To Dojo.File_Number
30243>>>    End_Object 
30244>>>
30244>>>    Object oMemberRanks_DD is a cMemberRanksDataDictionary
30246>>>        Set DDO_Server to oMembers_DD
30247>>>        Send Remove_Server_File Teachers.File_Number
30248>>>        //Send Remove_Server_File Members.File_Number
30248>>>    End_Object
30249>>>
30249>>>    Set Main_DD To oDojo_DD
30250>>>    Set Server  To oDojo_DD
30251>>>
30251>>>    Object oWebMainPanel is a cWebPanel
30253>>>        Set piColumnCount to 12
30254>>>
30254>>>        Object oDojoName is a cWebForm
30256>>>            Entry_Item Dojo.Name
30257>>>            Set piColumnSpan to 5
30258>>>            Set piColumnIndex to 0
30259>>>            Set psLabel to "Name:"
30260>>>            Set peLabelAlign to alignLeft
30261>>>        End_Object 
30262>>>
30262>>>        Object oDojo_Shibu is a cWebCheckbox
30264>>>            Entry_Item Dojo.Main
30265>>>            Set piColumnSpan to 5
30266>>>            Set psLabel to "Main Dojo"
30267>>>            Set psCaption to "This is my MAIN Dojo (all others are considered branch dojo to this one)"
30268>>>            Set pbServerOnChange to True
30269>>>            Set piColumnIndex to 5
30270>>>            Procedure OnChange String sNewValue String sOldValue
30273>>>                Forward Send OnChange sNewValue sOldValue
30275>>>                If (sNewValue <> sOldValue) Begin 
30277>>>                    Send Request_Save of oDojo_DD
30278>>>                End
30278>>>>
30278>>>            End_Procedure
30279>>>
30279>>>            Procedure Refresh Integer eMode
30282>>>                Forward Send Refresh eMode
30284>>>                If (not(AppSynching(ghoWebApp))) Begin 
30286>>>                    Reread Settings
30290>>>                    Unlock
30291>>>>
30291>>>                    If (Settings.MainDojo <> 0) Begin 
30293>>>                        If (Settings.MainDojo = Dojo.Dojo) Begin 
30295>>>                            WebSet pbRender to True
30296>>>                            WebSet psLabel of oInstructorsName to "Dojo-cho:"
30297>>>                            WebSet psLabel of oDojoName to "Dojo Name:"
30298>>>                        End
30298>>>>
30298>>>                        Else Begin 
30299>>>                            WebSet pbRender to False
30300>>>                            WebSet psLabel of oInstructorsName to "Shibu-cho:"
30301>>>                            WebSet psLabel of oDojoName to "Shibu-dojo Name:"
30302>>>                        End
30302>>>>
30302>>>                    End
30302>>>>
30302>>>                End
30302>>>>
30302>>>            End_Procedure
30303>>>        End_Object
30304>>>
30304>>>        Object oInstructorsName is a cWebForm
30306>>>            Entry_Item Dojo.DojoCho
30307>>>            Set piColumnSpan to 5
30308>>>            Set psLabel to "Dojo-cho:"
30309>>>            Procedure Prompt_Callback Handle hoPrompt
30312>>>                Forward Send Prompt_Callback hoPrompt
30314>>>                WebSet peUpdateMode of hoPrompt to umPromptValue
30315>>>            End_Procedure
30316>>>        End_Object 
30317>>>
30317>>>        Object oWebTabContainer1 is a cWebTabContainer
30319>>>            Set pbFillHeight to True
30320>>>
30320>>>            Object oWebTabPage2 is a cWebTabPage
30322>>>                Set psCaption to "Dojo Members"
30323>>>                Set piColumnCount to 12    
30324>>>
30324>>>                Object oWebButton1 is a cWebButton
30326>>>                    Set piColumnSpan to 2
30327>>>                    Set psCaption to "Add Member"
30328>>>                    Set piColumnIndex to 10
30329>>>                
30329>>>                    Procedure OnClick
30332>>>                        Register_Object oMembers
30332>>>                        Register_Object oDetailGrid
30332>>>                        WebSet psRowId of oMembers to ""
30334>>>                        WebSet piDojo of oMembers to Dojo.Dojo
30336>>>                        Send Popup of oMembers oDetailGrid                        
30337>>>                    End_Procedure
30338>>>                End_Object
30339>>>                
30339>>>                Object oDetailGrid is a cWebList
30341>>>                    Set Server to oMembers_DD
30342>>>                    Set piOrdering to 3
30343>>>                    Set pbFillHeight to True
30344>>>                    Set piColumnSpan to 12
30345>>>                    Set pbColumnSortable to True
30346>>>
30346>>>                    Object oMembers_Member is a cWebColumnLink
30348>>>                        Entry_Item Members.Member
30349>>>                        Set psCaption to "Member"
30350>>>                        Set piWidth to 65
30351>>>                        Set pbFixedWidth to True
30352>>>                        Set pbResizable to False
30353>>>                        Set pbServerOnClick to True
30354>>>
30354>>>                        Procedure OnClick String sRowID String sCellValue
30357>>>                            Forward Send OnClick sRowID sCellValue
30359>>>                            WebSet psRowId of oMembers to (SerializeRowID(GetRowID(Members.File_Number)))
30361>>>                            WebSet piDojo of oMembers to Dojo.Dojo
30363>>>                            Send Popup of oMembers oDetailGrid                        
30364>>>                        End_Procedure
30365>>>                    End_Object
30366>>>
30366>>>                    Object oMembersName is a cWebColumn
30368>>>                        Entry_Item Members.Name
30369>>>                        Set psCaption to "Name"
30370>>>                        Set piWidth to 194
30371>>>                    End_Object 
30372>>>        
30372>>>                    Object oMembersRankl is a cWebColumnCombo
30374>>>                        Entry_Item Members.Rank
30375>>>                        Set psCaption to "Rank"
30376>>>                        Set piWidth to 162
30377>>>                    End_Object 
30378>>>
30378>>>                    Object oMembersEmail is a cWebColumn
30380>>>                        Entry_Item Members.Email
30381>>>                        Set psCaption to "E-mail"
30382>>>                        Set piWidth to 151
30383>>>                    End_Object 
30384>>>
30384>>>                    Object oMembers_MemberType is a cWebColumnCombo
30386>>>                        Entry_Item Members.MemberType
30387>>>                        Set psCaption to "MemberType"
30388>>>                        Set piWidth to 166
30389>>>                    End_Object
30390>>>        
30390>>>                    Object oMembers_PaymentDue is a cWebColumnCombo
30392>>>                        Entry_Item Members.PaymentDue
30393>>>                        Set psCaption to "PaymentDue"
30394>>>                        Set piWidth to 166
30395>>>                    End_Object
30396>>>
30396>>>                    Object oMembersType is a cWebColumnCombo
30398>>>                        Entry_Item Members.Type
30399>>>                        Set psCaption to "Type"
30400>>>                        Set piWidth to 148
30401>>>                    End_Object 
30402>>>
30402>>>                    Object oRemoveMember is a cWebColumnImage
30404>>>                        Set piWidth to 57
30405>>>                        Set pbFixedWidth to True
30406>>>                        Set pbResizable to False
30407>>>                        Set psImageUrl to "Images/Delete.png"
30408>>>                        Set pbServerOnClick to True
30409>>>                        
30409>>>                        Procedure ImageCallback Integer eConfirmMode
30412>>>                            If (eConfirmMode = cmYes) Begin //delete
30414>>>                                Send Request_Delete of oMembers_DD
30415>>>                                Send FindDDRecordInBuffer of oDetailGrid
30416>>>                            End
30416>>>>
30416>>>                        End_Procedure
30417>>>                        WebPublishProcedure ImageCallback
30418>>>                        
30418>>>                        Procedure OnClick String sImage String sRowId
30421>>>                            Forward Send OnClick sImage sRowId
30423>>>                            Send ShowYesNo Self (RefProc(ImageCallback)) "Detele this member completely (all associated ranks for this member is also removed)?" 
30424>>>                        End_Procedure
30425>>>
30425>>>                        Procedure OnDefineTooltip String  ByRef sTooltip
30428>>>                            Forward Send OnDefineTooltip (&sTooltip)
30430>>>                            Move "Delete this member" to sTooltip
30431>>>                        End_Procedure
30432>>>                    End_Object
30433>>>                End_Object 
30434>>>            End_Object
30435>>>
30435>>>            Object oWebTabPage3 is a cWebTabPage
30437>>>                Set psCaption to "Dojo Seminars"
30438>>>                Set piColumnCount to 12    
30439>>>
30439>>>                Object oWebButton1 is a cWebButton
30441>>>                    Set piColumnSpan to 2
30442>>>                    Set psCaption to "Add Seminar"
30443>>>                    Set piColumnIndex to 10
30444>>>                
30444>>>                    Procedure OnClick
30447>>>                        Register_Object oMembers
30447>>>//                        Send Show_oMembers_FromXX of oMembers ""
30447>>>                    End_Procedure
30448>>>                End_Object
30449>>>
30449>>>                Object oWebGrid1 is a cWebList
30451>>>                    Set pbFillHeight to True
30452>>>                    Set Server to oSeminars_DD
30453>>>                    Set piOrdering to 3
30454>>>
30454>>>                    Object oSeminars_StartDate is a cWebColumnLink
30456>>>                        Entry_Item Seminars.StartDate
30457>>>                        Set psCaption to "StartDate"
30458>>>                        Set piWidth to 50
30459>>>                        Set pbServerOnClick to True
30460>>>                        Procedure OnClick String sRowID String sCellValue
30463>>>                            Register_Object oSeminars
30463>>>                            Send Show_oSeminars_FromXX of oSeminars sRowID
30464>>>                        End_Procedure
30465>>>                    End_Object
30466>>>
30466>>>                    Object oSeminars_Topic is a cWebColumn
30468>>>                        Entry_Item Seminars.Topic
30469>>>                        Set psCaption to "Topic"
30470>>>                        Set piWidth to 50
30471>>>                    End_Object
30472>>>
30472>>>                    Object oSeminars_Teachers is a cWebColumn
30474>>>                        Entry_Item Seminars.Teachers
30475>>>                        Set psCaption to "Teachers"
30476>>>                        Set piWidth to 50
30477>>>                    End_Object
30478>>>                End_Object
30479>>>            End_Object
30480>>>            Object oWebTabPage1 is a cWebTabPage
30482>>>                Set psCaption to "Dojo Info"
30483>>>                Set piColumnCount to 12    
30484>>>
30484>>>                Object oDojoAddress is a cWebForm
30486>>>                    Entry_Item Dojo.Address
30487>>>                    Set piColumnSpan to 5
30488>>>                    Set piColumnIndex to 0
30489>>>                    Set psLabel to "Address:"
30490>>>                    Set peLabelAlign to alignLeft
30491>>>                End_Object 
30492>>>
30492>>>                Object oDojoPAddress is a cWebForm
30494>>>                    Entry_Item Dojo.PAddress
30495>>>                    Set piColumnSpan to 5
30496>>>                    Set piColumnIndex to 0
30497>>>                    Set psLabel to "PAddress:"
30498>>>                    Set peLabelAlign to alignLeft
30499>>>                End_Object 
30500>>>
30500>>>                Object oDojoCity is a cWebForm
30502>>>                    Entry_Item Dojo.City
30503>>>                    Set piColumnSpan to 5
30504>>>                    Set piColumnIndex to 0
30505>>>                    Set psLabel to "City:"
30506>>>                    Set peLabelAlign to alignLeft
30507>>>                End_Object 
30508>>>
30508>>>                Object oDojoPhone is a cWebForm
30510>>>                    Entry_Item Dojo.Phone
30511>>>                    Set piColumnSpan to 5
30512>>>                    Set piColumnIndex to 0
30513>>>                    Set psLabel to "Phone:"
30514>>>                    Set peLabelAlign to alignLeft
30515>>>                End_Object 
30516>>>
30516>>>                Object oDojoMobile is a cWebForm
30518>>>                    Entry_Item Dojo.Mobile
30519>>>                    Set piColumnSpan to 5
30520>>>                    Set piColumnIndex to 0
30521>>>                    Set psLabel to "Mobile:"
30522>>>                    Set peLabelAlign to alignLeft
30523>>>                End_Object 
30524>>>
30524>>>                Object oDojoDescription is a cWebEdit
30526>>>                    Entry_Item Dojo.Description
30527>>>                    Set piColumnSpan to 5
30528>>>                    Set piColumnIndex to 0
30529>>>                    Set psLabel to "Description:"
30530>>>                    Set peLabelAlign to alignLeft
30531>>>                    Set piMinHeight to 100
30532>>>                    Set piHeight to 200
30533>>>                End_Object 
30534>>>            End_Object
30535>>>        End_Object
30536>>>
30536>>>    End_Object 
30537>>>
30537>>>    Procedure OnShow
30540>>>        Forward Send OnShow
30542>>>        Reread Settings
30546>>>        Unlock
30547>>>>
30547>>>        Send Clear of oDojo_DD
30548>>>        Move Settings.MainDojo to Dojo.Dojo
30549>>>        Send Find of oDojo_DD EQ 1
30550>>>    End_Procedure
30551>>>
30551>>>End_Object 
30552>    Use Members.wo
Including file: Members.wo    (C:\DojoManager\AppSrc\Members.wo)
30552>>>// C:\DojoManager\AppSrc\Members.wo
30552>>>// Members
30552>>>//
30552>>>
30552>>>Use cWebView.pkg
30552>>>Use cWebPanel.pkg
30552>>>Use cWebForm.pkg
30552>>>
30552>>>Use cDojoDataDictionary.dd
30552>>>Use cMembersDataDictionary.dd
30552>>>Use cTeachersDataDictionary.dd
30552>>>Use cMemberRanksDataDictionary.dd
30552>>>Use cPaymentsDataDictionary.dd
Including file: cPaymentsDataDictionary.dd    (C:\DojoManager\DDSrc\cPaymentsDataDictionary.dd)
30552>>>>>Use DataDict.pkg
30552>>>>>
30552>>>>>Open Payments
30554>>>>>Open Members
30556>>>>>Open Settings
30558>>>>>
30558>>>>>Object PaymentTypes is a DescriptionValidationTable
30560>>>>>    Procedure Fill_List
30563>>>>>        Forward Send Fill_List
30565>>>>>        Send Add_Table_Value "1" "Membership"
30566>>>>>        Send Add_Table_Value "2" "Rank"
30567>>>>>        Send Add_Table_Value "3" "Seminar"
30568>>>>>    End_Procedure
30569>>>>>End_Object
30570>>>>>
30570>>>>>Class cPaymentsDataDictionary is a DataDictionary
30571>>>>>    
30571>>>>>    Procedure Construct_Object
30573>>>>>        Forward Send Construct_Object
30575>>>>>        Set Main_File to Payments.File_Number
30576>>>>>
30576>>>>>        Set Add_System_File to Settings.File_Number DD_Lock_On_All
30577>>>>>
30577>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
30578>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
30579>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
30580>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
30581>>>>>
30581>>>>>        Set Field_Auto_Increment Field Payments.PaymentID to File_Field Settings.PaymentID
30582>>>>>
30582>>>>>        Set Field_Value_Table Field Payments.PaymentType to PaymentTypes
30583>>>>>
30583>>>>>    End_Procedure
30584>>>>>
30584>>>>>End_Class
30585>>>Use cWebTabContainer.pkg
30585>>>Use cWebTabPage.pkg
30585>>>Use cWebGrid.pkg
30585>>>Use cWebColumn.pkg
30585>>>Use cWebButton.pkg
30585>>>Use cWebGroup.pkg
30585>>>Use cWebHorizontalLine.pkg
30585>>>Use cWebLabel.pkg
30585>>>Use cWebSpacer.pkg
30585>>>Use cWebColumnCombo.pkg
30585>>>Use cWebImage.pkg
30585>>>
30585>>>Object oMembers is a cWebModalDialog
30587>>>    Set piColumnCount to 12
30588>>>    Set psCaption to "Members"
30589>>>    Set piWidth to 700
30590>>>    Set pbServerOnShow to True
30591>>>
30591>>>    Property String psRowId
30595>>>    Property Integer piDojo    
30599>>>    Property Handle phoCallbackObj
30603>>>    
30603>>>    Object oTeachers_DD is a cTeachersDataDictionary
30605>>>    End_Object
30606>>>
30606>>>    Object oDojo_DD is a cDojoDataDictionary
30608>>>    End_Object 
30609>>>
30609>>>    Object oMembers_DD is a cMembersDataDictionary
30611>>>        Set pbUseDDRelates to True
30612>>>        Set Field_Related_FileField Field Members.Dojo to File_Field Dojo.Dojo
30613>>>        Set DDO_Server to oDojo_DD
30614>>>        Set No_Delete_State to True
30615>>>
30615>>>        Procedure OnPreFind Integer eMessage
30618>>>            Forward Send OnPreFind eMessage
30620>>>        End_Procedure
30621>>>    End_Object 
30622>>>
30622>>>    Object oPayments_DD is a cPaymentsDataDictionary
30624>>>        Set pbUseDDRelates to True
30625>>>        Set Field_Related_FileField Payments.Member to File_Field Members.Member
30626>>>        Set Server to oMembers_DD
30627>>>        Set Constrain_File to Members.File_Number
30628>>>    End_Object
30629>>>
30629>>>    Object oMemberRanks_DD is a cMemberRanksDataDictionary
30631>>>        Set Constrain_file to Members.File_number
30632>>>        Set DDO_Server to oMembers_DD
30633>>>        Set DDO_Server to oTeachers_DD
30634>>>    End_Object
30635>>>
30635>>>    Set Main_DD To oMembers_DD
30636>>>    Set Server  To oMembers_DD
30637>>>    Set pbServerOnHide to True
30638>>>    Set pbClearKeys to False
30639>>>    Set pbFindKeys to False
30640>>>
30640>>>
30640>>>    Object oWebMainPanel is a cWebPanel
30642>>>        Set piColumnCount to 12
30643>>>
30643>>>        Object oWebGroup1 is a cWebGroup
30645>>>            Set psCaption to "Member"
30646>>>            Set piColumnCount to 12   
30647>>>
30647>>>            Object oMembersName is a cWebForm
30649>>>                Entry_Item Members.Name
30650>>>                Set piColumnSpan to 8
30651>>>                Set psLabel to "Name:"
30652>>>                Set peLabelAlign to alignLeft
30653>>>                Set pbPromptButton to False
30654>>>            End_Object 
30655>>>
30655>>>            Object oWebImage1 is a cWebImage
30657>>>                Set psUrl to "Images/delete.png"
30658>>>                Set piHeight to 35
30659>>>                Set piColumnIndex to 8
30660>>>                Set pePosition to wiCenter
30661>>>                Set pbServerOnClick to True
30662>>>                Set psToolTip to "Delete this member completely"
30663>>>
30663>>>                Procedure DeleteMember Integer eResponse
30666>>>                    If (eResponse = cmYes) Begin 
30668>>>                        Send Request_Delete of oMembers_DD
30669>>>                        Send Cancel
30670>>>                    End
30670>>>>
30670>>>                End_Procedure
30671>>>                WebPublishProcedure DeleteMember
30672>>>                
30672>>>                Procedure OnClick
30675>>>                    Forward Send OnClick
30677>>>                    Send ShowYesNo Self (RefProc(DeleteMember)) "Do you want to delete this member completely?"
30678>>>                End_Procedure
30679>>>            End_Object
30680>>>
30680>>>            Object oMembersEmail is a cWebForm
30682>>>                Entry_Item Members.Email
30683>>>                Set piColumnSpan to 8
30684>>>                Set psLabel to "Email:"
30685>>>                Set peLabelAlign to alignLeft
30686>>>            End_Object 
30687>>>        End_Object
30688>>>
30688>>>        Object oWebTabContainer1 is a cWebTabContainer
30690>>>            Object oWebTabPage1 is a cWebTabPage
30692>>>                Set psCaption to "Details"
30693>>>                Set piColumnCount to 12    
30694>>>
30694>>>                Object oWebGroup2 is a cWebGroup
30696>>>                    Set psCaption to "Dojo Membership Details"
30697>>>                    Set piColumnCount to 12   
30698>>>
30698>>>                    Object oDojoDojo is a cWebForm
30700>>>                        Set Server to oDojo_DD
30701>>>                        Entry_Item Dojo.Name
30702>>>                        Set piColumnSpan to 8
30703>>>                        Set psLabel to "Dojo:"
30704>>>                        Set peLabelAlign to alignLeft
30705>>>                    End_Object 
30706>>>
30706>>>                    Object oMembers_DojoJoinDate is a cWebDateForm
30708>>>                        Entry_Item Members.DojoJoinDate
30709>>>                        Set piColumnSpan to 8
30710>>>                        Set psLabel to "Dojo Join Date:"
30711>>>                    End_Object
30712>>>
30712>>>                    Object oMembersType is a cWebCombo
30714>>>                        Entry_Item Members.Type
30715>>>                        Set piColumnSpan to 8
30716>>>                        Set psLabel to "Role:"
30717>>>                        Set peLabelAlign to alignLeft
30718>>>                    End_Object 
30719>>>
30719>>>                    Object oMembers_Active is a cWebCheckbox
30721>>>                        Entry_Item Members.Active
30722>>>                        Set piColumnSpan to 4
30723>>>                        Set psLabel to "Active:"
30724>>>                        Set psCaption to "Not Active"
30725>>>                        Set piColumnIndex to 8
30726>>>                    End_Object
30727>>>                End_Object
30728>>>
30728>>>                Object oWebGroup3 is a cWebGroup
30730>>>                    Set psCaption to "Jinenkan Membership Details"
30731>>>                    Set piColumnCount to 12   
30732>>>
30732>>>                    Object oMembers_Member is a cWebForm
30734>>>                        Entry_Item Members.Member
30735>>>                        Set piColumnSpan to 4
30736>>>                        Set psLabel to "Member No:"
30737>>>                        Set pbPromptButton to False
30738>>>                    End_Object
30739>>>
30739>>>                    Object oMembers_JoinDate is a cWebDateForm
30741>>>                        Entry_Item Members.MemberSince
30742>>>                        Set piColumnSpan to 6
30743>>>                        Set psLabel to "Member Since:"
30744>>>                        Set piColumnIndex to 6
30745>>>                    End_Object
30746>>>
30746>>>                    Object oMembers_MemberType is a cWebCombo
30748>>>                        Entry_Item Members.MemberType
30749>>>                        Set piColumnSpan to 6
30750>>>                        Set psLabel to "MemberType:"
30751>>>                    End_Object
30752>>>
30752>>>                    Object oMembers_PaymentDue is a cWebCombo
30754>>>                        Entry_Item Members.PaymentDue
30755>>>                        Set piColumnSpan to 6
30756>>>                        Set psLabel to "PaymentDue:"
30757>>>                        Set piColumnIndex to 6
30758>>>                    End_Object
30759>>>                End_Object
30760>>>            End_Object
30761>>>
30761>>>            Object oWebTabPage2 is a cWebTabPage
30763>>>                Set psCaption to "Current Ranks"
30764>>>                Set piColumnCount to 12    
30765>>>                Object oMembers_Rank is a cWebCombo
30767>>>                    Entry_Item Members.Rank
30768>>>                    Set piColumnSpan to 8
30769>>>                    Set psLabel to "Kobudo Rank:"
30770>>>                End_Object
30771>>>
30771>>>                Object oWebSpacer1 is a cWebSpacer
30773>>>                End_Object
30774>>>
30774>>>                Object oMembers_BikenRank is a cWebCombo
30776>>>                    Entry_Item Members.BikenRank
30777>>>                    Set piColumnSpan to 8
30778>>>                    Set psLabel to "Biken Rank:"
30779>>>                End_Object
30780>>>
30780>>>                Object oMembers_NitoRank is a cWebCombo
30782>>>                    Entry_Item Members.NitoRank
30783>>>                    Set piColumnSpan to 8
30784>>>                    Set psLabel to "Nito Rank:"
30785>>>                End_Object
30786>>>
30786>>>                Object oMembers_TantoRank is a cWebCombo
30788>>>                    Entry_Item Members.TantoRank
30789>>>                    Set piColumnSpan to 8
30790>>>                    Set psLabel to "Tanto Rank:"
30791>>>                End_Object
30792>>>
30792>>>                Object oMembers_JutteRank is a cWebCombo
30794>>>                    Entry_Item Members.JutteRank
30795>>>                    Set piColumnSpan to 8
30796>>>                    Set psLabel to "Jutte Rank:"
30797>>>                End_Object
30798>>>
30798>>>                Object oMembers_KusariRank is a cWebCombo
30800>>>                    Entry_Item Members.KusariRank
30801>>>                    Set piColumnSpan to 8
30802>>>                    Set psLabel to "Kusari Rank:"
30803>>>                End_Object
30804>>>            End_Object
30805>>>            
30805>>>            Object oWebTabPage3 is a cWebTabPage
30807>>>                Set psCaption to "Contact Details"
30808>>>                Set piColumnCount to 12    
30809>>>
30809>>>                Object oMembersAddress is a cWebForm
30811>>>                    Entry_Item Members.Address
30812>>>                    Set piColumnSpan to 12
30813>>>                    Set piColumnIndex to 0
30814>>>                    Set psLabel to "Address:"
30815>>>                    Set peLabelAlign to alignLeft
30816>>>                End_Object 
30817>>>
30817>>>                Object oMembersPAddress is a cWebForm
30819>>>                    Entry_Item Members.PAddress
30820>>>                    Set piColumnSpan to 12
30821>>>                    Set piColumnIndex to 0
30822>>>                    Set psLabel to "PAddress:"
30823>>>                    Set peLabelAlign to alignLeft
30824>>>                End_Object 
30825>>>
30825>>>                Object oMembersCity is a cWebForm
30827>>>                    Entry_Item Members.City
30828>>>                    Set piColumnSpan to 12
30829>>>                    Set piColumnIndex to 0
30830>>>                    Set psLabel to "City:"
30831>>>                    Set peLabelAlign to alignLeft
30832>>>                End_Object 
30833>>>
30833>>>                Object oMembersCountry is a cWebForm
30835>>>                    Entry_Item Members.Country
30836>>>                    Set piColumnSpan to 12
30837>>>                    Set piColumnIndex to 0
30838>>>                    Set psLabel to "Country:"
30839>>>                    Set peLabelAlign to alignLeft
30840>>>                End_Object 
30841>>>
30841>>>                Object oMembersPhone is a cWebForm
30843>>>                    Entry_Item Members.Phone
30844>>>                    Set piColumnSpan to 12
30845>>>                    Set piColumnIndex to 0
30846>>>                    Set psLabel to "Phone:"
30847>>>                    Set peLabelAlign to alignLeft
30848>>>                End_Object 
30849>>>
30849>>>                Object oMembersMobile is a cWebForm
30851>>>                    Entry_Item Members.Mobile
30852>>>                    Set piColumnSpan to 12
30853>>>                    Set piColumnIndex to 0
30854>>>                    Set psLabel to "Mobile:"
30855>>>                    Set peLabelAlign to alignLeft
30856>>>                End_Object 
30857>>>
30857>>>                Object oMembersWebpage is a cWebForm
30859>>>                    Entry_Item Members.Webpage
30860>>>                    Set piColumnSpan to 12
30861>>>                    Set piColumnIndex to 0
30862>>>                    Set psLabel to "Webpage:"
30863>>>                    Set peLabelAlign to alignLeft
30864>>>                End_Object 
30865>>>            End_Object
30866>>>    
30866>>>            Object oWebTabPage4 is a cWebTabPage
30868>>>                Set psCaption to "Rank Tests"
30869>>>                Set piColumnCount to 12    
30870>>>
30870>>>                Object oWebGrid1 is a cWebGrid
30872>>>                    Set pbFillHeight to True
30873>>>                    Set Server to oMemberRanks_DD
30874>>>                    Set piOrdering to 1
30875>>>
30875>>>                    Object oMemberRanks_Type is a cWebColumnCombo
30877>>>                        Entry_Item MemberRanks.Type
30878>>>                        Set psCaption to "Type"
30879>>>                        Set piWidth to 50
30880>>>                    End_Object
30881>>>
30881>>>                    Object oRanks_Rank is a cWebColumnCombo
30883>>>//                        Set Server to oRanks_DD
30883>>>//                        Entry_Item Ranks.Name
30883>>>//                        Entry_Item MemberRanks.Rank
30883>>>                        Set psCaption to "Rank"
30884>>>                        Set piWidth to 50
30885>>>                        Set pbServerOnFocus to True
30886>>>                        Set pbServerOnChange to True
30887>>>
30887>>>                        Procedure OnFocus
30890>>>                            Forward Send OnFocus
30892>>>//                            Send DDFieldEntryMessage 
30892>>>                            Send OnFill
30893>>>                        End_Procedure
30894>>>                        
30894>>>                        Procedure OnFill
30897>>>                            Integer iCount i iType
30897>>>                            Handle hoValidationObject
30897>>>                            String sDescr
30897>>>                            Forward Send OnFill
30899>>>                            Get Field_Current_Value of oMemberRanks_DD Field MemberRanks.Type to iType
30900>>>                            If (iType = 2) Begin 
30902>>>                                Move (BikenRanks(oMemberRanks_DD(Self)))  to hoValidationObject
30903>>>                                Get Item_Count of hoValidationObject to iCount
30904>>>                                For i from 0 to (iCount - 1)
30910>>>>
30910>>>                                    Move (Find_Code_Description(hoValidationObject, i)) to sDescr
30911>>>                                    If (sDescr <> "") Begin 
30913>>>                                        Send AddComboItem (String(i)) sDescr
30914>>>                                    End
30914>>>>
30914>>>                                Loop
30915>>>>
30915>>>                            End
30915>>>>
30915>>>                        End_Procedure
30916>>>
30916>>>                        Procedure OnChange String sNewValue String sOldValue
30919>>>                            Forward Send OnChange sNewValue sOldValue
30921>>>                            Set Field_Changed_Value of oMemberRanks_DD Field MemberRanks.Rank to sNewValue
30922>>>                        End_Procedure
30923>>>                    End_Object
30924>>>
30924>>>                    Object oInstructors_Instructor is a cWebColumn
30926>>>                        Set Server to oTeachers_DD
30927>>>                        Entry_Item Teachers.Name
30928>>>                        Set psCaption to "Instructor"
30929>>>                        Set piWidth to 50
30930>>>                    End_Object
30931>>>
30931>>>                    Object oMemberRanks_Date is a cWebColumnDate
30933>>>                        Set Server to oMemberRanks_DD
30934>>>                        Entry_Item MemberRanks.Date
30935>>>                        Set psCaption to "Date"
30936>>>                        Set piWidth to 50
30937>>>                    End_Object
30938>>>
30938>>>                    Object oMemberRanks_Notes is a cWebColumn
30940>>>                        Set Server to oMemberRanks_DD
30941>>>                        Entry_Item MemberRanks.Notes
30942>>>                        Set psCaption to "Notes"
30943>>>                        Set piWidth to 50
30944>>>                    End_Object
30945>>>
30945>>>                    Procedure OnChangeCurrentRow String sFromRowID String sToRowID
30948>>>                        Forward Send OnChangeCurrentRow sFromRowID sToRowID
30950>>>                    End_Procedure
30951>>>                End_Object
30952>>>            End_Object
30953>>>
30953>>>            Object oWebTabPage5 is a cWebTabPage
30955>>>                Set psCaption to "Payments"
30956>>>                Set piColumnCount to 12   
30957>>>
30957>>>                Object oPaymentList is a cWebList
30959>>>                    Set Server to oPayments_DD
30960>>>                    Set pbFillHeight to True
30961>>>                    Object oWebColumn1 is a cWebColumn
30963>>>                        Entry_Item Payments.Date
30964>>>                        Set psCaption to "Date"
30965>>>                        Set piWidth to 50
30966>>>                    End_Object
30967>>>
30967>>>                    Object oPayments_PaymentType is a cWebColumnCombo
30969>>>                        Entry_Item Payments.PaymentType
30970>>>                        Set psCaption to "PaymentType"
30971>>>                        Set piWidth to 50
30972>>>                    End_Object
30973>>>
30973>>>                    Object oPayments_Payment is a cWebColumn
30975>>>                        Entry_Item Payments.Payment
30976>>>                        Set psCaption to "Payment"
30977>>>                        Set piWidth to 50
30978>>>                    End_Object
30979>>>
30979>>>                    Object oPayments_Comment is a cWebColumn
30981>>>                        Entry_Item Payments.Comment
30982>>>                        Set psCaption to "Comment"
30983>>>                        Set piWidth to 50
30984>>>                    End_Object
30985>>>
30985>>>                    Object oRemovePayment is a cWebColumnImage
30987>>>                        Set piWidth to 60
30988>>>                        Set pbFixedWidth to True
30989>>>                        Set pbResizable to False
30990>>>                        Set psImageUrl to "Images/Delete.png"
30991>>>                        Set pbServerOnClick to True
30992>>>                        
30992>>>                        Procedure ImageCallback Integer eConfirmMode
30995>>>                            If (eConfirmMode = cmYes) Begin //delete
30997>>>                                Send Request_Delete of oPayments_DD
30998>>>                                Send FindDDRecordInBuffer of oPaymentList
30999>>>                            End
30999>>>>
30999>>>                        End_Procedure
31000>>>                        WebPublishProcedure ImageCallback
31001>>>                        
31001>>>                        Procedure OnClick String sImage String sRowId
31004>>>                            Forward Send OnClick sImage sRowId
31006>>>                            Send ShowYesNo Self (RefProc(ImageCallback)) "Detele this payment permanentely?" 
31007>>>                        End_Procedure
31008>>>
31008>>>                        Procedure OnDefineTooltip String  ByRef sTooltip
31011>>>                            Forward Send OnDefineTooltip (&sTooltip)
31013>>>                            Move "Delete this payment" to sTooltip
31014>>>                        End_Procedure
31015>>>                    End_Object
31016>>>
31016>>>                    Procedure OnLoad
31019>>>                        Forward Send OnLoad
31021>>>                        Send Find of oPayments_DD FIRST_RECORD 1
31022>>>                    End_Procedure
31023>>>
31023>>>                End_Object
31024>>>            End_Object 
31025>>>        End_Object
31026>>>
31026>>>        Object oWebButton1 is a cWebButton
31028>>>            Set piColumnSpan to 3
31029>>>            Set psCaption to "Save"
31030>>>            Set piColumnIndex to 6
31031>>>        
31031>>>            Procedure OnClick
31034>>>                Handle hoGrid
31034>>>                WebGet phoCallbackObj of oMembers to hoGrid
31035>>>                Send Request_Save of oMembers_DD
31036>>>                Send FindDDRecordInBuffer of hoGrid
31037>>>                Send Hide of oMembers
31038>>>            End_Procedure
31039>>>        End_Object
31040>>>
31040>>>        Object oWebButton2 is a cWebButton
31042>>>            Set piColumnSpan to 3
31043>>>            Set psCaption to "Cancel"
31044>>>            Set piColumnIndex to 9
31045>>>        
31045>>>            Procedure OnClick
31048>>>                Send Cancel
31049>>>            End_Procedure
31050>>>        End_Object
31051>>>    End_Object 
31052>>>
31052>>>    Procedure OnShow
31055>>>        Forward Send OnShow
31057>>>        String sRowId
31057>>>        Integer iDojo
31057>>>        WebGet psRowId of oMembers to sRowId
31058>>>        WebGet piDojo of oMembers to iDojo
31059>>>        If (sRowId <> "") Begin 
31061>>>            Send FindByRowId of oMembers_DD Members.File_Number (DeserializeRowID(sRowId))
31062>>>            WebSet pbEnabled of oMembers_Member to False
31063>>>            WebSet pbEnabled of oDojoDojo to True 
31064>>>        End
31064>>>>
31064>>>        Else Begin 
31065>>>            Send Clear of oMembers_DD
31066>>>            Send Clear of oDojo_DD
31067>>>            Move iDojo to Dojo.Dojo 
31068>>>            Send Find of oDojo_DD EQ 1
31069>>>            WebSet pbEnabled of oMembers_Member to True
31070>>>            WebSet pbEnabled of oDojoDojo to False
31071>>>        End
31071>>>>
31071>>>    End_Procedure
31072>>>
31072>>>    Procedure Popup Handle hoReturnObject
31075>>>        WebSet phoCallbackObj of oMembers to hoReturnObject
31076>>>        Forward Send Popup hoReturnObject
31078>>>    End_Procedure
31079>>>
31079>>>    Procedure Show_oMembers_FromXX String sRowId Integer iDojo
31082>>>        Send Show 
31083>>>    End_Procedure
31084>>>
31084>>>End_Object 
31085>    Use Instructors.wo
Including file: Instructors.wo    (C:\DojoManager\AppSrc\Instructors.wo)
31085>>>// C:\DojoManager\AppSrc\Members.wo
31085>>>// Members
31085>>>//
31085>>>
31085>>>Use cWebView.pkg
31085>>>Use cWebPanel.pkg
31085>>>Use cWebForm.pkg
31085>>>
31085>>>Use cTeachersDataDictionary.dd
31085>>>
31085>>>Object oInstructors is a cWebView
31087>>>    Set piColumnCount to 12
31088>>>    Set psCaption to "Instructors"
31089>>>    Set piWidth to 700
31090>>>
31090>>>    Object oTeachers_DD is a cTeachersDataDictionary
31092>>>    End_Object
31093>>>
31093>>>    Set Main_DD to oTeachers_DD
31094>>>    Set Server  to oTeachers_DD
31095>>>
31095>>>    Object oWebMainPanel is a cWebPanel
31097>>>        Set piColumnCount to 12
31098>>>
31098>>>        Object oInstructorsName is a cWebForm
31100>>>            Entry_Item Teachers.Name
31101>>>            Set piColumnSpan to 12
31102>>>            Set piColumnIndex to 0
31103>>>            Set psLabel to "Name:"
31104>>>            Set peLabelAlign to alignLeft
31105>>>        End_Object 
31106>>>
31106>>>        Object oMembersType is a cWebCombo
31108>>>            Entry_Item Teachers.Type
31109>>>            Set piColumnSpan to 6
31110>>>            Set piColumnIndex to 0
31111>>>            Set psLabel to "Type:"
31112>>>            Set peLabelAlign to alignLeft
31113>>>        End_Object 
31114>>>    End_Object 
31115>>>
31115>>>End_Object 
31116>    Use Seminars.wo
Including file: Seminars.wo    (C:\DojoManager\AppSrc\Seminars.wo)
31116>>>// C:\DojoManager\AppSrc\Seminars.wo
31116>>>// Seminars
31116>>>//
31116>>>
31116>>>Use cWebView.pkg
31116>>>Use cWebPanel.pkg
31116>>>Use cWebForm.pkg
31116>>>Use cWebEdit.pkg
31116>>>Use cWebGrid.pkg
31116>>>Use cWebColumn.pkg
31116>>>
31116>>>Use cDojoDataDictionary.dd
31116>>>Use cSeminarsDataDictionary.dd
31116>>>Use cSeminarAttendeesDataDictionary.dd
Including file: cSeminarAttendeesDataDictionary.dd    (C:\DojoManager\DDSrc\cSeminarAttendeesDataDictionary.dd)
31116>>>>>Use DataDict.pkg
31116>>>>>
31116>>>>>Open SeminarAttendees
31118>>>>>Open Seminars
31120>>>>>Open Members
31122>>>>>Open Teachers
31124>>>>>Open Payments
31126>>>>>
31126>>>>>Register_Function ValidateSeminarAttendeesSeminarFee Integer iColumn Number nValue Returns Boolean
31126>>>>>Register_Function ValidateSeminarAttendeesMembershipFee Integer iColumn Integer iValue Returns Boolean
31126>>>>>Register_Function ValidateSeminarAttendeesParticipant Integer iColumn String sValue Returns Boolean
31126>>>>>
31126>>>>>Class cSeminarAttendeesDataDictionary is a DataDictionary
31127>>>>>    
31127>>>>>    Procedure Construct_Object
31129>>>>>        Forward Send Construct_Object
31131>>>>>        Set Main_File to SeminarAttendees.File_Number
31132>>>>>
31132>>>>>        Set Add_System_File to Payments.File_Number DD_Lock_On_All
31133>>>>>
31133>>>>>        Set Add_Server_File to Seminars.File_Number
31134>>>>>
31134>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
31135>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
31136>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
31137>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
31138>>>>>
31138>>>>>        Set Field_Validate_msg Field SeminarAttendees.Participant to get_ValidateSeminarAttendeesParticipant
31139>>>>>
31139>>>>>        Set Field_Validate_msg Field SeminarAttendees.SeminarFee to get_ValidateSeminarAttendeesSeminarFee
31140>>>>>
31140>>>>>        Set Field_Validate_msg Field SeminarAttendees.MembershipFee to get_ValidateSeminarAttendeesMembershipFee
31141>>>>>
31141>>>>>    End_Procedure
31142>>>>>
31142>>>>>    Function ValidateSeminarAttendeesSeminarFee Integer iColumn Number nValue Returns Boolean
31144>>>>>        If (nValue = 0) Begin 
31146>>>>>            Set Field_Changed_Value Field SeminarAttendees.SeminarFee to Seminars.AttendanceFee
31147>>>>>        End
31147>>>>>>
31147>>>>>    End_Function
31148>>>>>
31148>>>>>    Procedure Backout
31150>>>>>        Forward Send Backout
31152>>>>>        Move (Seminars.TotAttendanceFee - SeminarAttendees.SeminarFee) to Seminars.TotAttendanceFee
31153>>>>>        If (OPERATION_MODE = MODE_DELETING) Begin //deleting a participant should also delete payments
31155>>>>>            If (SeminarAttendees.MembPayID) Begin 
31157>>>>>                Clear Payments 
31158>>>>>                Move SeminarAttendees.MembPayID to Payments.PaymentID
31159>>>>>                Find eq Payments by Index.1
31160>>>>>>
31160>>>>>                If (Found) Begin 
31162>>>>>                    Delete Payments 
31163>>>>>                End
31163>>>>>>
31163>>>>>            End
31163>>>>>>
31163>>>>>            If (SeminarAttendees.RankPayID) Begin 
31165>>>>>                Clear Payments 
31166>>>>>                Move SeminarAttendees.RankPayID to Payments.PaymentID
31167>>>>>                Find eq Payments by Index.1
31168>>>>>>
31168>>>>>                If (Found) Begin 
31170>>>>>                    Delete Payments 
31171>>>>>                End
31171>>>>>>
31171>>>>>            End
31171>>>>>>
31171>>>>>            If (SeminarAttendees.SeminarPayID) Begin 
31173>>>>>                Clear Payments 
31174>>>>>                Move SeminarAttendees.SeminarPayID to Payments.PaymentID
31175>>>>>                Find eq Payments by Index.1
31176>>>>>>
31176>>>>>                If (Found) Begin 
31178>>>>>                    Delete Payments 
31179>>>>>                End
31179>>>>>>
31179>>>>>            End
31179>>>>>>
31179>>>>>        End
31179>>>>>>
31179>>>>>    End_Procedure
31180>>>>>
31180>>>>>    Procedure Update
31182>>>>>        Forward Send Update
31184>>>>>//        Move Seminars.Dojo to SeminarAttendees.Dojo
31184>>>>>        If (SeminarAttendees.MebershipPayed) Begin //membership is payed at the semianr
31186>>>>>            Lock
31187>>>>>>
31187>>>>>            Clear Payments
31188>>>>>            Move (Settings.PaymentID + 1) to Payments.PaymentID
31189>>>>>            Move SeminarAttendees.MemberID to Payments.Member
31190>>>>>            Move (CurrentDateTime()) to Payments.Date
31191>>>>>            Move 1 to Payments.PaymentType
31192>>>>>            Move SeminarAttendees.MembershipFee to Payments.Payment
31193>>>>>            SaveRecord Payments
31194>>>>>            Unlock
31195>>>>>>
31195>>>>>            Reread Settings
31199>>>>>            Move Payments.PaymentID to Settings.PaymentID 
31200>>>>>            SaveRecord Settings
31201>>>>>            Unlock
31202>>>>>>
31202>>>>>            Move Payments.PaymentID to SeminarAttendees.MembPayID
31203>>>>>        End
31203>>>>>>
31203>>>>>        If (SeminarAttendees.RankPayed) Begin //ranktest is payed at the semianr
31205>>>>>            Lock
31206>>>>>>
31206>>>>>            Clear Payments
31207>>>>>            Move (Settings.PaymentID + 1) to Payments.PaymentID
31208>>>>>            Move SeminarAttendees.MemberID to Payments.Member
31209>>>>>            Move (CurrentDateTime()) to Payments.Date
31210>>>>>            Move 2 to Payments.PaymentType
31211>>>>>            Move SeminarAttendees.RankFee to Payments.Payment
31212>>>>>            SaveRecord Payments
31213>>>>>            Unlock
31214>>>>>>
31214>>>>>            Reread Settings
31218>>>>>            Move Payments.PaymentID to Settings.PaymentID 
31219>>>>>            SaveRecord Settings
31220>>>>>            Unlock
31221>>>>>>
31221>>>>>            Move Payments.PaymentID to SeminarAttendees.RankPayID
31222>>>>>        End
31222>>>>>>
31222>>>>>        If (SeminarAttendees.Payed) Begin //seminar is payed at the semianr
31224>>>>>            Lock
31225>>>>>>
31225>>>>>            Clear Payments
31226>>>>>            Move (Settings.PaymentID + 1) to Payments.PaymentID
31227>>>>>            Move SeminarAttendees.MemberID to Payments.Member
31228>>>>>            Move (CurrentDateTime()) to Payments.Date
31229>>>>>            Move 3 to Payments.PaymentType
31230>>>>>            Move SeminarAttendees.SeminarFee to Payments.Payment
31231>>>>>            SaveRecord Payments
31232>>>>>            Unlock
31233>>>>>>
31233>>>>>            Reread Settings
31237>>>>>            Move Payments.PaymentID to Settings.PaymentID 
31238>>>>>            SaveRecord Settings
31239>>>>>            Unlock
31240>>>>>>
31240>>>>>            Move Payments.PaymentID to SeminarAttendees.SeminarPayID
31241>>>>>        End
31241>>>>>>
31241>>>>>
31241>>>>>        Move (Seminars.TotAttendanceFee + SeminarAttendees.SeminarFee) to Seminars.TotAttendanceFee
31242>>>>>    End_Procedure
31243>>>>>
31243>>>>>    Function ValidateSeminarAttendeesMembershipFee Integer iColumn Integer iValue Returns Boolean
31245>>>>>        Integer iMemberId
31245>>>>>        String sName
31245>>>>>        Boolean bSave
31245>>>>>        Get Field_Current_Value Field SeminarAttendees.Participant to sName
31246>>>>>        Get Field_Current_Value Field SeminarAttendees.MemberID to iMemberId
31247>>>>>        If (iValue = 0) Begin 
31249>>>>>            Clear Members
31250>>>>>            Move sName to Members.Name 
31251>>>>>            Find ge Members by Index.4
31252>>>>>>
31252>>>>>            Repeat
31252>>>>>>
31252>>>>>                If ((Found) and (Members.Name = sName)) Begin 
31254>>>>>                    Set Field_Changed_Value Field SeminarAttendees.MemberID to Members.Member
31255>>>>>                    Set Field_Changed_Value Field SeminarAttendees.ParticipantEmail to (Trim(Members.Email))
31256>>>>>                    Clear Dojo
31257>>>>>                    Move Members.Dojo to Dojo.Dojo
31258>>>>>                    Find eq Dojo by Index.1
31259>>>>>>
31259>>>>>                    Set Field_Changed_Value Field SeminarAttendees.ParticipantDojo to (Trim(Dojo.Name))
31260>>>>>                    Move True to bSave
31261>>>>>                End
31261>>>>>>
31261>>>>>                Find gt Members by Index.4
31262>>>>>>
31262>>>>>            Until (bSave)
31264>>>>>        End
31264>>>>>>
31264>>>>>        
31264>>>>>        Get Field_Current_Value Field SeminarAttendees.MemberID to iMemberId
31265>>>>>        Clear Members
31266>>>>>        Move iMemberId to Members.Member
31267>>>>>        Find eq Members by Index.1
31268>>>>>>
31268>>>>>        If (Found) Begin 
31270>>>>>            If (Members.Type = 1) Begin //full member
31272>>>>>                Set Field_Changed_Value iColumn to Settings.FullMemberFee
31273>>>>>            End
31273>>>>>>
31273>>>>>            Else Begin //associate member
31274>>>>>                Set Field_Changed_Value iColumn to Settings.AssociateMemberFee
31275>>>>>            End
31275>>>>>>
31275>>>>>        End
31275>>>>>>
31275>>>>>    End_Function
31276>>>>>
31276>>>>>    Function ValidateSeminarAttendeesParticipant Integer iColumn String sValue Returns Boolean
31278>>>>>        Boolean bSave
31278>>>>>        If (sValue <> "") Begin //if there is a participant, find him/her in members
31280>>>>>            Clear Members
31281>>>>>            Move sValue to Members.Name 
31282>>>>>            Find ge Members by Index.4
31283>>>>>>
31283>>>>>            Repeat
31283>>>>>>
31283>>>>>                If ((Found) and (Members.Name = sValue)) Begin 
31285>>>>>                    Set Field_Changed_Value Field SeminarAttendees.MemberID to Members.Member
31286>>>>>                    Set Field_Changed_Value Field SeminarAttendees.ParticipantEmail to (Trim(Members.Email))
31287>>>>>                    Clear Dojo
31288>>>>>                    Move Members.Dojo to Dojo.Dojo
31289>>>>>                    Find eq Dojo by Index.1
31290>>>>>>
31290>>>>>                    Set Field_Changed_Value Field SeminarAttendees.ParticipantDojo to (Trim(Dojo.Name))
31291>>>>>                    Move True to bSave
31292>>>>>                End
31292>>>>>>
31292>>>>>                Find gt Members by Index.4
31293>>>>>>
31293>>>>>            Until (bSave)
31295>>>>>        End
31295>>>>>>
31295>>>>>    End_Function
31296>>>>>
31296>>>>>End_Class
31297>>>Use cMembersDataDictionary.dd
31297>>>Use cWebTabContainer.pkg
31297>>>Use cWebTabPage.pkg
31297>>>
31297>>>Object oSeminars is a cWebView
31299>>>    Set piColumnCount to 12
31300>>>    Set psCaption to "Seminars"
31301>>>    Set pbServerOnShow to True
31302>>>    Set pbClearAfterSave to False
31303>>>    
31303>>>    Property String psRowId
31307>>>
31307>>>    Object oDojo_DD is a cDojoDataDictionary
31309>>>    End_Object 
31310>>>
31310>>>    Object oSeminars_DD is a cSeminarsDataDictionary
31312>>>        Set DDO_Server to oDojo_DD
31313>>>        Set Constrain_File to Dojo.File_Number
31314>>>        // this lets you save a new parent DD from within child DD
31314>>>        Set Allow_Foreign_New_Save_State to False
31315>>>    End_Object 
31316>>>
31316>>>    Object oSeminarAttendees_DD is a cSeminarAttendeesDataDictionary
31318>>>        Set DDO_Server to oSeminars_DD
31319>>>        Set Constrain_File To Seminars.File_Number
31320>>>        Set Allow_Foreign_New_Save_State to False
31321>>>    End_Object 
31322>>>
31322>>>    Set Main_DD To oSeminars_DD
31323>>>    Set Server  To oSeminars_DD
31324>>>
31324>>>    Object oWebMainPanel is a cWebPanel
31326>>>        Set piColumnCount to 12
31327>>>
31327>>>        Object oDojo_Dojo is a cWebForm
31329>>>            Entry_Item Dojo.Dojo
31330>>>
31330>>>            Set Server to oSeminarAttendees_DD
31331>>>            Set piColumnSpan to 0
31332>>>            Set psLabel to "Dojo:"
31333>>>            Set pbRender to False
31334>>>        End_Object
31335>>>
31335>>>        Object oSeminars_Seminar is a cWebForm
31337>>>            Entry_Item Seminars.Seminar
31338>>>            Set piColumnSpan to 0
31339>>>            Set psLabel to "Seminar:"
31340>>>            Set pbRender to False
31341>>>        End_Object
31342>>>
31342>>>        Object oSeminarsTopic is a cWebForm
31344>>>            Entry_Item Seminars.Topic
31345>>>            Set piColumnSpan to 5
31346>>>            Set piColumnIndex to 0
31347>>>            Set psLabel to "Topic:"
31348>>>            Set peLabelAlign to alignLeft
31349>>>        End_Object 
31350>>>
31350>>>        Object oSeminarsTeachers is a cWebForm
31352>>>            Entry_Item Seminars.Teachers
31353>>>            Set piColumnSpan to 5
31354>>>            Set piColumnIndex to 0
31355>>>            Set psLabel to "Teachers:"
31356>>>            Set peLabelAlign to alignLeft
31357>>>        End_Object 
31358>>>
31358>>>        Object oSeminarsStartDate is a cWebForm
31360>>>            Entry_Item Seminars.StartDate
31361>>>            Set piColumnSpan to 2
31362>>>            Set piColumnIndex to 0
31363>>>            Set psLabel to "StartDate:"
31364>>>            Set peLabelAlign to alignLeft
31365>>>        End_Object 
31366>>>
31366>>>        Object oSeminarsEndDate is a cWebForm
31368>>>            Entry_Item Seminars.EndDate
31369>>>            Set piColumnSpan to 2
31370>>>            Set piColumnIndex to 3
31371>>>            Set psLabel to "EndDate:"
31372>>>            Set peLabelAlign to alignLeft
31373>>>        End_Object 
31374>>>
31374>>>        Object oWebTabContainer1 is a cWebTabContainer
31376>>>        Object oWebTabPage2 is a cWebTabPage
31378>>>            Set psCaption to "Attendees"
31379>>>            Set piColumnCount to 12    
31380>>>
31380>>>            Object oDetailGrid is a cWebGrid
31382>>>                Set Server to oSeminarAttendees_DD
31383>>>                Set piOrdering to 1
31384>>>                Set pbFillHeight to True
31385>>>                Set piColumnSpan to 12
31386>>>    
31386>>>                Object oMembersName is a cWebColumn
31388>>>                    Entry_Item SeminarAttendees.Participant
31389>>>                    Set psCaption to "Name"
31390>>>                    Set piWidth to 217
31391>>>                    Set pbPromptButton to True
31392>>>                    Set phoPrompt to oMembersWebLookup
31393>>>                    Procedure Prompt_Callback Handle hoPrompt
31396>>>                        Forward Send Prompt_Callback hoPrompt
31398>>>                        WebSet peUpdateMode of hoPrompt to umPromptValue
31399>>>                    End_Procedure
31400>>>                End_Object 
31401>>>    
31401>>>                Object oMembersID is a cWebColumn
31403>>>                    Entry_Item SeminarAttendees.MemberID
31404>>>                    Set psCaption to "MemberID"
31405>>>                    Set piWidth to 217
31406>>>                    Set pbRender to False
31407>>>                End_Object 
31408>>>
31408>>>                Object oDojoDojo is a cWebColumn
31410>>>                    Entry_Item SeminarAttendees.ParticipantDojo
31411>>>                    Set psCaption to "Dojo"
31412>>>                    Set piWidth to 174
31413>>>//                        Set pbPromptButton to True
31413>>>//                        Set phoPrompt to oDojoWebLookup
31413>>>                End_Object 
31414>>>    
31414>>>                Object oMembersEmail is a cWebColumn
31416>>>                    Entry_Item SeminarAttendees.ParticipantEmail
31417>>>                    Set psCaption to "Email"
31418>>>                    Set piWidth to 191
31419>>>                End_Object 
31420>>>    
31420>>>                Object oSeminarAttendeesSeminarFee is a cWebColumn
31422>>>                    Entry_Item SeminarAttendees.SeminarFee
31423>>>                    Set psCaption to "SeminarFee"
31424>>>                    Set piWidth to 82
31425>>>                    Set pbFixedWidth to True
31426>>>                    Set pbResizable to False
31427>>>                End_Object 
31428>>>    
31428>>>                Object oSeminarAttendeesPayed is a cWebColumnCheckbox
31430>>>                    Entry_Item SeminarAttendees.Payed
31431>>>                    Set psCaption to "Payed"
31432>>>                    Set piWidth to 50
31433>>>                    Set pbFixedWidth to True
31434>>>                    Set pbResizable to False
31435>>>                End_Object 
31436>>>    
31436>>>                Object oRanksRank is a cWebColumn
31438>>>                    Entry_Item SeminarAttendees.RankTest
31439>>>                    Set psCaption to "RankTest"
31440>>>                    Set piWidth to 66
31441>>>                    Set pbFixedWidth to True
31442>>>                    Set pbResizable to False
31443>>>                    Set pbPromptButton to True
31444>>>                End_Object 
31445>>>    
31445>>>                Object oSeminarAttendeesRankFee is a cWebColumn
31447>>>                    Entry_Item SeminarAttendees.RankFee
31448>>>                    Set psCaption to "RankFee"
31449>>>                    Set piWidth to 63
31450>>>                    Set pbFixedWidth to True
31451>>>                    Set pbResizable to False
31452>>>                End_Object 
31453>>>    
31453>>>                Object oSeminarAttendeesRankPayed is a cWebColumnCheckbox
31455>>>                    Entry_Item SeminarAttendees.RankPayed
31456>>>                    Set psCaption to "RankPayed"
31457>>>                    Set piWidth to 78
31458>>>                    Set pbFixedWidth to True
31459>>>                    Set pbResizable to False
31460>>>                End_Object 
31461>>>    
31461>>>                Object oTeachersName is a cWebColumn
31463>>>                    Entry_Item SeminarAttendees.Examiner
31464>>>                    Set psCaption to "Examinator"
31465>>>                    Set piWidth to 191
31466>>>                    Set pbPromptButton to True
31467>>>                    Set phoPrompt to oTeachersWebLookup
31468>>>                End_Object 
31469>>>    
31469>>>                Object oSeminarAttendeesMembershipFee is a cWebColumn
31471>>>                    Entry_Item SeminarAttendees.MembershipFee
31472>>>                    Set psCaption to "MembershipFee"
31473>>>                    Set piWidth to 100
31474>>>                    Set pbFixedWidth to True
31475>>>                    Set pbResizable to False
31476>>>                End_Object 
31477>>>    
31477>>>                Object oSeminarAttendeesMebershipPayed is a cWebColumnCheckbox
31479>>>                    Entry_Item SeminarAttendees.MebershipPayed
31480>>>                    Set psCaption to "MebershipPayed"
31481>>>                    Set piWidth to 123
31482>>>                End_Object 
31483>>>
31483>>>                Object oRemoveParticipant is a cWebColumnImage
31485>>>                    Set piWidth to 57
31486>>>                    Set pbFixedWidth to True
31487>>>                    Set pbResizable to False
31488>>>                    Set psImageUrl to "Images/Delete.png"
31489>>>                    Set pbServerOnClick to True
31490>>>                    
31490>>>                    Procedure ImageCallback Integer eConfirmMode
31493>>>                        If (eConfirmMode = cmYes) Begin //delete
31495>>>                            Send Request_Delete of oSeminarAttendees_DD
31496>>>                            Send FindDDRecordInBuffer of oDetailGrid
31497>>>                        End
31497>>>>
31497>>>                    End_Procedure
31498>>>                    WebPublishProcedure ImageCallback
31499>>>                    
31499>>>                    Procedure OnClick String sImage String sRowId
31502>>>                        Forward Send OnClick sImage sRowId
31504>>>                        Send ShowYesNo Self (RefProc(ImageCallback)) "Detele this participant and all payments?" 
31505>>>                    End_Procedure
31506>>>
31506>>>                    Procedure OnDefineTooltip String  ByRef sTooltip
31509>>>                        Forward Send OnDefineTooltip (&sTooltip)
31511>>>                        Move "Delete this participant" to sTooltip
31512>>>                    End_Procedure
31513>>>                End_Object
31514>>>
31514>>>                Procedure OnLoad
31517>>>                    Forward Send OnLoad
31519>>>                    Send Find of oSeminarAttendees_DD FIRST_RECORD 1
31520>>>                End_Procedure
31521>>>            End_Object 
31522>>>        End_Object
31523>>>
31523>>>            Object oWebTabPage1 is a cWebTabPage
31525>>>                Set psCaption to "Information"
31526>>>                Set piColumnCount to 12    
31527>>>
31527>>>                Object oSeminarsNotes is a cWebEdit
31529>>>                    Entry_Item Seminars.Notes
31530>>>                    Set piColumnSpan to 10
31531>>>                    Set piColumnIndex to 0
31532>>>                    Set psLabel to "Notes:"
31533>>>                    Set pbFillHeight to True
31534>>>                    Set peLabelAlign to alignLeft
31535>>>                    Set piMinHeight to 200
31536>>>                End_Object 
31537>>>
31537>>>                Object oSeminarsTotalCost is a cWebForm
31539>>>                    Entry_Item Seminars.TotalCost
31540>>>                    Set piColumnSpan to 3
31541>>>                    Set piColumnIndex to 0
31542>>>                    Set psLabel to "Total Cost:"
31543>>>                    Set peLabelAlign to alignLeft
31544>>>                End_Object 
31545>>>
31545>>>                Object oSeminarsTotAttendanceFee is a cWebForm
31547>>>                    Entry_Item Seminars.TotAttendanceFee
31548>>>                    Set piColumnSpan to 3
31549>>>                    Set psLabel to "Total Fee:"
31550>>>                    Set peLabelAlign to alignLeft
31551>>>                End_Object 
31552>>>
31552>>>                Object oSeminarsAttendanceFee is a cWebForm
31554>>>                    Entry_Item Seminars.AttendanceFee
31555>>>                    Set piColumnSpan to 3
31556>>>                    Set psLabel to "Attendance Fee:"
31557>>>                    Set peLabelAlign to alignLeft
31558>>>                    Set piColumnIndex to 3
31559>>>                End_Object 
31560>>>            End_Object
31561>>>        End_Object
31562>>>    End_Object 
31563>>>
31563>>>    Procedure OnShow
31566>>>        String sRowId
31566>>>        WebGet psRowId of oSeminars to sRowId
31567>>>        Send FindByRowId of oSeminars_DD Seminars.File_Number (DeserializeRowID(sRowId))
31568>>>        Forward Send OnShow
31570>>>    End_Procedure
31571>>>    
31571>>>    Procedure Show_oSeminars_FromXX String sRowId
31574>>>        WebSet psRowId of oSeminars to sRowId
31575>>>        Send Show
31576>>>    End_Procedure
31577>>>End_Object 
31578>    Use Settings.wo
Including file: Settings.wo    (C:\DojoManager\AppSrc\Settings.wo)
31578>>>// C:\DojoManager\AppSrc\Settings.wo
31578>>>// Settings
31578>>>//
31578>>>
31578>>>Use cWebView.pkg
31578>>>Use cWebPanel.pkg
31578>>>Use cWebTabContainer.pkg
31578>>>Use cWebTabPage.pkg
31578>>>Use cWebForm.pkg
31578>>>
31578>>>Use cSettingsDataDictionary.dd
Including file: cSettingsDataDictionary.dd    (C:\DojoManager\DDSrc\cSettingsDataDictionary.dd)
31578>>>>>Use DataDict.pkg
31578>>>>>
31578>>>>>Open Settings
31580>>>>>
31580>>>>>Class cSettingsDataDictionary is a DataDictionary
31581>>>>>    
31581>>>>>    Procedure Construct_Object
31583>>>>>        Forward Send Construct_Object
31585>>>>>        Set Main_File to Settings.File_Number
31586>>>>>
31586>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
31587>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
31588>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
31589>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
31590>>>>>
31590>>>>>    End_Procedure
31591>>>>>
31591>>>>>End_Class
31592>>>
31592>>>Object oSettings is a cWebView
31594>>>    Set piColumnCount to 12
31595>>>    Set psCaption to "Settings"
31596>>>    Set piWidth to 700
31597>>>
31597>>>    Object oSettings_DD is a cSettingsDataDictionary
31599>>>    End_Object 
31600>>>
31600>>>    Set Main_DD To oSettings_DD
31601>>>    Set Server  To oSettings_DD
31602>>>
31602>>>
31602>>>    Object oWebMainPanel is a cWebPanel
31604>>>        Set piColumnCount to 12
31605>>>
31605>>>        Object oWebTabContainer is a cWebTabContainer
31607>>>            Set pbFillHeight to True
31608>>>            Set piColumnSpan to 12
31609>>>            Set pbShowLabel to False
31610>>>
31610>>>            Object oPage1 is a cWebTabPage
31612>>>                Set piColumnCount to 12
31613>>>                Set psCaption to "Fees"
31614>>>
31614>>>                Object oSettingsMainDojo is a cWebForm
31616>>>                    Entry_Item Settings.MainDojo
31617>>>                    Set piColumnSpan to 4
31618>>>                    Set piColumnIndex to 0
31619>>>                    Set psLabel to "Main Dojo:"
31620>>>                    Set peLabelAlign to alignLeft
31621>>>                End_Object 
31622>>>
31622>>>                Object oSettingsFullMemberFee is a cWebForm
31624>>>                    Entry_Item Settings.FullMemberFee
31625>>>                    Set piColumnSpan to 4
31626>>>                    Set piColumnIndex to 0
31627>>>                    Set psLabel to "Full Member Fee:"
31628>>>                    Set peLabelAlign to alignLeft
31629>>>                End_Object 
31630>>>
31630>>>                Object oSettingsAssociateMemberFee is a cWebForm
31632>>>                    Entry_Item Settings.AssociateMemberFee
31633>>>                    Set piColumnSpan to 4
31634>>>                    Set piColumnIndex to 0
31635>>>                    Set psLabel to "Associate Member Fee:"
31636>>>                    Set peLabelAlign to alignLeft
31637>>>                End_Object 
31638>>>
31638>>>                Object oSettingsKyuRankFee is a cWebForm
31640>>>                    Entry_Item Settings.KyuRankFee
31641>>>                    Set piColumnSpan to 4
31642>>>                    Set piColumnIndex to 0
31643>>>                    Set psLabel to "Kyu Rank Fee:"
31644>>>                    Set peLabelAlign to alignLeft
31645>>>                End_Object 
31646>>>
31646>>>                Object oSettingsShodanFee is a cWebForm
31648>>>                    Entry_Item Settings.ShodanFee
31649>>>                    Set piColumnSpan to 4
31650>>>                    Set piColumnIndex to 0
31651>>>                    Set psLabel to "Shodan Fee:"
31652>>>                    Set peLabelAlign to alignLeft
31653>>>                End_Object 
31654>>>
31654>>>                Object oSettingsNidanFee is a cWebForm
31656>>>                    Entry_Item Settings.NidanFee
31657>>>                    Set piColumnSpan to 4
31658>>>                    Set piColumnIndex to 0
31659>>>                    Set psLabel to "Nidan Fee:"
31660>>>                    Set peLabelAlign to alignLeft
31661>>>                End_Object 
31662>>>
31662>>>                Object oSettingsSandanFee is a cWebForm
31664>>>                    Entry_Item Settings.SandanFee
31665>>>                    Set piColumnSpan to 4
31666>>>                    Set piColumnIndex to 0
31667>>>                    Set psLabel to "Sandan Fee:"
31668>>>                    Set peLabelAlign to alignLeft
31669>>>                End_Object 
31670>>>            End_Object 
31671>>>
31671>>>            Object oPage2 is a cWebTabPage
31673>>>                Set piColumnCount to 12
31674>>>                Set psCaption to "Auto Increment IDs"
31675>>>
31675>>>                Object oSettingsMembersID is a cWebForm
31677>>>                    Entry_Item Settings.MembersID
31678>>>                    Set piColumnSpan to 4
31679>>>                    Set piColumnIndex to 0
31680>>>                    Set psLabel to "Members ID:"
31681>>>                    Set peLabelAlign to alignLeft
31682>>>                End_Object 
31683>>>
31683>>>                Object oSettingsDojoID is a cWebForm
31685>>>                    Entry_Item Settings.DojoID
31686>>>                    Set piColumnSpan to 4
31687>>>                    Set piColumnIndex to 0
31688>>>                    Set psLabel to "Dojo ID:"
31689>>>                    Set peLabelAlign to alignLeft
31690>>>                End_Object 
31691>>>
31691>>>                Object oSettingsInstructorsID is a cWebForm
31693>>>                    Entry_Item Settings.InstructorsID
31694>>>                    Set piColumnSpan to 4
31695>>>                    Set piColumnIndex to 0
31696>>>                    Set psLabel to "Instructors ID:"
31697>>>                    Set peLabelAlign to alignLeft
31698>>>                End_Object 
31699>>>            End_Object 
31700>>>        End_Object 
31701>>>    End_Object 
31702>>>
31702>>>End_Object 
31703>
31703>    Procedure OnLoad
31706>        Forward Send OnLoad
31708>        If (Settings.GuestMembersID < 1000) Begin //initialize guest member id to 1000
31710>        Reread Settings
31714>            Move 1000 to Settings.GuestMembersID 
31715>            SaveRecord Settings
31716>        Unlock
31717>        End
31717>    End_Procedure
31718>    
31718>End_Object
31719>
31719>Send StartWebApp of oWebApp
31720>
Summary
Memory Available: 1281269759
Total Warnings : 0
Total Errors   : 0
Total Symbols  : 20867
Total Resources: 0
Total Commands : 31719
Total Windows  : 1
Total Pages    : 1
Static Data    : 313259
Message area   : 216454
Total Blocks   : 13183
